2025-10-14 02:51:01.629 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:51:02.790 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:51:02.839 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:51:02.841 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:51:02.901 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:51:03.501 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 02:51:03.510 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 02:51:03.565 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 02:51:03.577 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 02:51:03.780 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 02:51:03.781 | INFO     | fullon_ohlcv_service.utils.add_symbols | 37 | Successfully initialized symbol binance:BTC/USDT
2025-10-14 02:51:03.787 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 02:51:03.788 | INFO     | fullon_ohlcv_service.utils.add_symbols | 131 | Found 2 symbols for exchange binance
2025-10-14 02:51:03.789 | INFO     | fullon_ohlcv_service.utils.add_symbols | 143 | Exchange binance initialization: 1/2 successful
2025-10-14 02:51:03.790 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 02:51:03.791 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 44 | Error initializing symbol binance:BTC/USDT: Init failed
2025-10-14 02:51:03.797 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 02:51:03.799 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 147 | Error initializing symbols for exchange binance: Database error
2025-10-14 02:51:03.826 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 02:51:03.826 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 44 | Error initializing symbol binance:BTC/USDT: Repository creation failed
2025-10-14 02:51:03.839 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:51:03.841 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 2 symbols to initialize
2025-10-14 02:51:03.842 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 2/2 successful
2025-10-14 02:51:03.853 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:51:03.854 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 02:51:03.855 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/1 successful
2025-10-14 02:51:03.863 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:51:03.865 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=2
2025-10-14 02:51:03.864 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:51:03.867 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:51:03.866 | WARNING  | fullon_ohlcv_service.utils.add_symbols | 72 | No symbols found
2025-10-14 02:51:03.868 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 02:51:03.868 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 02:51:03.869 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:51:03.869 | INFO     | fullon_ohlcv_service.trade.live_collector | 75 | Stopping live trade collection
2025-10-14 02:51:03.870 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:03.870 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:51:03.873 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:51:03.873 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 2 symbols to initialize
2025-10-14 02:51:03.875 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 95 | Failed to initialize symbol <MagicMock name='mock.exchange_name' id='134998131214048'>:ETH/USDT
2025-10-14 02:51:03.876 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/2 successful
2025-10-14 02:51:03.882 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:51:03.883 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 102 | Error during bulk symbol initialization: Database connection failed
2025-10-14 02:51:03.890 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:51:03.891 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 02:51:03.891 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/1 successful
2025-10-14 02:51:03.901 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 02:51:03.902 | INFO     | fullon_ohlcv_service.utils.add_symbols | 131 | Found 2 symbols for exchange binance
2025-10-14 02:51:03.902 | INFO     | fullon_ohlcv_service.utils.add_symbols | 143 | Exchange binance initialization: 2/2 successful
2025-10-14 02:51:03.910 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 02:51:03.911 | WARNING  | fullon_ohlcv_service.utils.add_symbols | 128 | No symbols found for exchange binance
2025-10-14 02:51:03.969 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:51:03.970 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 02:51:03.971 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:51:03.972 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 02:51:03.973 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 02:51:03.974 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:51:03.975 | WARNING  | fullon_ohlcv_service.daemon | 230 | Error stopping collector during cleanup error=object MagicMock can't be used in 'await' expression
2025-10-14 02:51:03.976 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:51:03.985 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-13 02:00:00.000000', 50000.0, 50252.12, 49556.17, 49724.13, 1578.2341), ('2025-10-13 03:00:00.000000', 49724.13, 50176.58, 49258.46, 49868.5, 1277.5327), ('2025-10-13 04:00:00.000000', 49868.5, 49934.33, 49580.75, 49781.75, 612.3281), ('2025-10-13 05:00:00.000000', 49781.75, 49889.5, 49595.78, 49831.95, 1162.6387), ('2025-10-13 06:00:00.000000', 49831.95, 49981.33, 49666.27, 49927.25, 636.7004), ('2025-10-13 07:00:00.000000', 49927.25, 49992.07, 49627.6, 49896.91, 650.7528), ('2025-10-13 08:00:00.000000', 49896.91, 50377.57, 49430.37, 49498.67, 579.1591), ('2025-10-13 09:00:00.000000', 49498.67, 49899.2, 49407.23, 49494.4, 832.9252), ('2025-10-13 10:00:00.000000', 49494.4, 49625.55, 49042.1, 49327.77, 997.5735), ('2025-10-13 11:00:00.000000', 49327.77, 49785.93, 49289.57, 49445.03, 1172.1548), ('2025-10-13 12:00:00.000000', 49445.03, 49534.05, 49231.39, 49357.2, 972.3791), ('2025-10-13 13:00:00.000000', 49357.2, 49576.47, 48926.55, 48958.0, 1044.9177), ('2025-10-13 14:00:00.000000', 48958.0, 49107.84, 48763.95, 49077.71, 1183.5133), ('2025-10-13 15:00:00.000000', 49077.71, 49254.86, 48884.94, 49029.94, 963.5206), ('2025-10-13 16:00:00.000000', 49029.94, 49183.36, 48880.61, 48935.34, 734.9769), ('2025-10-13 17:00:00.000000', 48935.34, 49098.29, 48491.88, 48972.11, 890.5019), ('2025-10-13 18:00:00.000000', 48972.11, 49040.7, 48598.56, 48615.72, 1080.2082), ('2025-10-13 19:00:00.000000', 48615.72, 48874.11, 48286.0, 48321.37, 1586.4076), ('2025-10-13 20:00:00.000000', 48321.37, 48804.42, 47927.5, 48098.72, 915.6411), ('2025-10-13 21:00:00.000000', 48098.72, 48442.8, 47663.0, 48231.34, 1008.3496), ('2025-10-13 22:00:00.000000', 48231.34, 48644.47, 48226.85, 48536.06, 967.046), ('2025-10-13 23:00:00.000000', 48536.06, 48821.57, 48306.14, 48345.26, 995.9429), ('2025-10-14 00:00:00.000000', 48345.26, 48739.14, 47976.67, 47998.03, 974.5023), ('2025-10-14 01:00:00.000000', 47998.03, 48194.73, 47558.29, 47811.0, 1511.716)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:51:04.012 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 01:51:03.951476', 45000.0, 1.0484062660880136, 'sell', 'market'), ('2025-10-14 01:51:13.101777', 45045.76003528582, 1.6157228431907804, 'buy', 'market'), ('2025-10-14 01:51:23.824362', 45062.139155710734, 0.5270106617890796, 'buy', 'market'), ('2025-10-14 01:51:26.628851', 45039.06498354714, 1.7500979144733992, 'sell', 'market'), ('2025-10-14 01:51:24.871228', 45040.91339185113, 0.06256315339613067, 'buy', 'limit'), ('2025-10-14 01:51:49.742441', 45085.10874133765, 1.7491068498417015, 'buy', 'market'), ('2025-10-14 01:51:40.323038', 45118.29679559911, 0.11995444923946837, 'buy', 'limit'), ('2025-10-14 01:51:41.820342', 45064.44504855318, 0.5910048076388095, 'sell', 'limit'), ('2025-10-14 01:52:12.768244', 45055.0314398094, 0.12557919731944184, 'buy', 'market'), ('2025-10-14 01:52:18.090110', 45090.87863432827, 1.9438033160154817, 'buy', 'market'), ('2025-10-14 01:52:21.193156', 45019.28499494568, 1.8774631695094022, 'sell', 'limit'), ('2025-10-14 01:52:34.021841', 45004.64730181901, 0.73272741930006, 'sell', 'market'), ('2025-10-14 01:52:54.194072', 44990.62371173054, 0.08613560430804147, 'sell', 'market'), ('2025-10-14 01:53:04.018683', 44955.15607522229, 1.622268363012828, 'sell', 'limit'), ('2025-10-14 01:51:25.246792', 44972.66668054637, 0.5996066901293331, 'sell', 'limit'), ('2025-10-14 01:52:43.540331', 44941.541119909496, 1.0367741470167033, 'buy', 'market'), ('2025-10-14 01:52:53.798500', 44878.393340094095, 0.29091569623475744, 'sell', 'market'), ('2025-10-14 01:52:55.726425', 44925.519605927955, 0.16847538466677167, 'sell', 'market'), ('2025-10-14 01:53:08.001860', 44949.27491874727, 0.6700571813861153, 'buy', 'market'), ('2025-10-14 01:52:06.776477', 44912.92685891191, 0.795260120957453, 'buy', 'market'), ('2025-10-14 01:52:11.385456', 44944.10593822087, 1.8956628359860237, 'buy', 'market'), ('2025-10-14 01:51:09.826163', 44849.9823147942, 0.7865772902215854, 'sell', 'market'), ('2025-10-14 01:52:32.181046', 44872.97119844615, 1.6701475878500338, 'sell', 'market'), ('2025-10-14 01:54:10.594544', 44970.19474238067, 0.36814873138920634, 'sell', 'market'), ('2025-10-14 01:51:40.192724', 45037.09540872554, 1.8079138123125231, 'sell', 'market'), ('2025-10-14 01:52:17.340776', 45078.91123863577, 1.6323287210858561, 'buy', 'market'), ('2025-10-14 01:53:49.669366', 45100.49029848093, 1.3699960848893544, 'buy', 'limit'), ('2025-10-14 01:52:23.851307', 45064.84195792091, 1.4968863089599547, 'buy', 'limit'), ('2025-10-14 01:54:47.101872', 45067.24360738587, 1.5327618627829669, 'sell', 'market'), ('2025-10-14 01:52:30.486809', 45054.509742226444, 1.7440501438211313, 'sell', 'market'), ('2025-10-14 01:52:46.931666', 45095.52409856619, 0.9809015854633932, 'buy', 'market'), ('2025-10-14 01:53:26.341761', 45085.66063609802, 1.2530217518918085, 'sell', 'market'), ('2025-10-14 01:51:33.997908', 45099.517584107874, 1.2277787263983342, 'buy', 'market'), ('2025-10-14 01:52:52.899062', 45092.40467921657, 1.9665876456194025, 'sell', 'market'), ('2025-10-14 01:51:37.860866', 45066.27303427527, 0.06558923347617357, 'sell', 'market'), ('2025-10-14 01:51:57.635736', 45097.99528370634, 0.1417476525663696, 'buy', 'market'), ('2025-10-14 01:55:47.096264', 45088.52367944577, 1.886516048181307, 'sell', 'market'), ('2025-10-14 01:55:26.169958', 45162.88397478179, 1.7313941464438647, 'buy', 'market'), ('2025-10-14 01:51:33.343716', 45138.16835171704, 1.7469677013414466, 'sell', 'limit'), ('2025-10-14 01:56:54.802301', 45105.04640263329, 0.9201873580666858, 'sell', 'market'), ('2025-10-14 01:53:42.440436', 45142.2132502513, 1.3400475225204709, 'buy', 'market'), ('2025-10-14 01:54:07.770876', 45154.18685570437, 1.4175934987238141, 'sell', 'market'), ('2025-10-14 01:51:27.321746', 45132.64190176158, 0.019940114871168292, 'sell', 'limit'), ('2025-10-14 01:56:07.968356', 45240.50931082596, 0.8618569278075765, 'buy', 'market'), ('2025-10-14 01:51:19.378404', 45236.84365702357, 0.17299041130406917, 'buy', 'market'), ('2025-10-14 01:57:41.566661', 45213.15863182581, 1.4291309632638391, 'sell', 'market'), ('2025-10-14 01:54:24.191362', 45107.6062847509, 0.6577661733042554, 'buy', 'market'), ('2025-10-14 01:52:46.576023', 45159.941385224585, 1.227747021289866, 'buy', 'market'), ('2025-10-14 01:51:20.651972', 45152.120089569675, 0.7149095074894022, 'buy', 'market'), ('2025-10-14 01:54:55.358337', 45204.68347771683, 0.41986244446549864, 'buy', 'market'), ('2025-10-14 01:57:40.081076', 45180.198686495176, 0.25762969956023024, 'sell', 'market'), ('2025-10-14 01:54:22.377176', 45151.70115271865, 0.9696902608315224, 'buy', 'market'), ('2025-10-14 01:54:29.185180', 45201.557797530106, 0.4026320029576461, 'buy', 'limit'), ('2025-10-14 01:59:06.161959', 45188.097275813656, 1.236731958055501, 'sell', 'market'), ('2025-10-14 01:53:20.796980', 45163.11083417225, 1.603647885969714, 'buy', 'market'), ('2025-10-14 01:51:38.904416', 45150.47734331785, 1.0605706294510198, 'sell', 'market'), ('2025-10-14 01:51:42.596964', 45211.549581463056, 1.9386226143353498, 'buy', 'market'), ('2025-10-14 01:53:41.193500', 45207.757204828355, 1.8503608870837998, 'sell', 'market'), ('2025-10-14 01:57:08.723800', 45206.31428784193, 0.8616101374576094, 'sell', 'market'), ('2025-10-14 01:56:41.874094', 45171.75369236119, 1.3750613593918326, 'sell', 'limit'), ('2025-10-14 01:52:55.351016', 45141.477282656044, 1.5130164432026798, 'sell', 'market'), ('2025-10-14 01:55:33.335101', 45153.62572091927, 0.15319137300367014, 'buy', 'market'), ('2025-10-14 01:59:34.453276', 45187.542667739195, 1.8373408243160017, 'sell', 'market'), ('2025-10-14 01:56:32.163773', 45195.570539849825, 1.1429750781248413, 'sell', 'market'), ('2025-10-14 02:01:10.097268', 45193.62776340104, 1.2331487485878576, 'sell', 'market'), ('2025-10-14 01:55:07.874831', 45190.414399942565, 0.22677598442226427, 'sell', 'market'), ('2025-10-14 01:51:31.907228', 45204.63626861133, 0.3139882698176299, 'sell', 'limit'), ('2025-10-14 01:54:28.259132', 45141.966773738764, 0.7966692668410413, 'sell', 'market'), ('2025-10-14 01:52:39.321816', 45125.24185576261, 1.4280592577702524, 'sell', 'limit'), ('2025-10-14 01:55:23.647742', 45120.0855635281, 0.23847159952933203, 'sell', 'market'), ('2025-10-14 01:54:25.888106', 45121.674393248126, 1.1904751895142334, 'sell', 'market'), ('2025-10-14 01:54:39.377262', 45117.12451383312, 1.459259545681539, 'buy', 'market'), ('2025-10-14 01:51:25.931996', 45068.583947032916, 1.4225611807942347, 'sell', 'market'), ('2025-10-14 01:58:49.570296', 45108.373569369105, 1.8528449984694864, 'buy', 'limit'), ('2025-10-14 02:00:08.561580', 45122.288609678886, 0.4755721179864897, 'buy', 'limit'), ('2025-10-14 01:58:03.795251', 45191.68748160701, 0.09284657568873936, 'sell', 'limit'), ('2025-10-14 01:52:55.051468', 45217.482581324104, 1.315120775440723, 'buy', 'market'), ('2025-10-14 02:03:26.880124', 45180.25692587918, 1.4380141199514929, 'buy', 'market'), ('2025-10-14 01:51:56.774558', 45202.11967641546, 0.5618731217125114, 'sell', 'market'), ('2025-10-14 01:52:26.129725', 45223.19534340655, 1.9679727326331562, 'sell', 'market'), ('2025-10-14 02:02:20.042676', 45202.045774908016, 0.801834691389723, 'sell', 'limit'), ('2025-10-14 01:59:09.208220', 45194.71131842367, 0.7850791712146982, 'sell', 'market'), ('2025-10-14 01:54:38.162618', 45161.60271736166, 1.4891248461156157, 'sell', 'market'), ('2025-10-14 01:51:14.989812', 45131.74432285531, 1.3726309268733858, 'buy', 'market'), ('2025-10-14 02:01:04.162136', 45117.8082305041, 0.04937762679935743, 'buy', 'limit'), ('2025-10-14 02:01:23.981596', 45135.81476605055, 0.4182895198959318, 'buy', 'market'), ('2025-10-14 01:55:05.764212', 45048.91463459883, 1.9494037609381212, 'sell', 'market'), ('2025-10-14 01:55:24.739718', 45033.51754069574, 1.740988918592345, 'buy', 'market'), ('2025-10-14 02:01:18.917828', 44994.285737554696, 0.15593716682066633, 'sell', 'market'), ('2025-10-14 02:01:53.019665', 45054.07556739053, 1.584263526257062, 'buy', 'market'), ('2025-10-14 01:51:19.566656', 45157.34657232533, 1.5210527385022377, 'buy', 'market'), ('2025-10-14 02:02:03.613570', 45107.127473024375, 1.7158033746195562, 'sell', 'market'), ('2025-10-14 02:01:56.168548', 45064.3256234061, 1.3320479734398532, 'buy', 'market'), ('2025-10-14 01:55:34.902605', 45084.21858006511, 0.7924349093243881, 'buy', 'market'), ('2025-10-14 01:55:36.210162', 45059.13712408458, 1.7012781169182492, 'sell', 'market'), ('2025-10-14 02:03:53.970556', 45131.41104820767, 1.63618487290204, 'buy', 'market'), ('2025-10-14 01:56:32.823572', 45153.097493325324, 1.1073518326211276, 'buy', 'market'), ('2025-10-14 01:52:49.085702', 45126.46695019775, 1.6060914556948125, 'buy', 'market'), ('2025-10-14 02:00:53.521828', 45119.4844761778, 0.323442567177183, 'sell', 'market'), ('2025-10-14 02:07:05.223755', 45121.02734390823, 1.6010817614037525, 'sell', 'market')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:51:04.020 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:51:00.000000', 47487.68, 47488.41306989367, 46601.25929321684, 47266.31111624969, 3595.9531)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:51:04.042 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:51:00.000000', 42236.03, 43128.38793908789, 41769.02386081446, 42353.298372291436, 8214.3496)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:51:04.042 | INFO     | fullon_ohlcv_service.daemon | 155 | Symbol already collecting symbol=BTC/USDT
2025-10-14 02:51:04.046 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:51:00.000000', 45602.04, 46451.79534846809, 45515.69766361374, 45904.99191895903, 6225.663)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:51:04.048 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:51:00.000000', 38833.73, 39817.83390785366, 38035.260267892816, 38604.93190126522, 8404.7104)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:51:04.049 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 02:51:04.036959', 47633.89, 6.23442178, 'sell', 'limit')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:51:04.056 | INFO     | fullon_ohlcv_service.daemon | 159 | Symbol already collecting symbol=BTC/USDT
2025-10-14 02:51:04.067 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 02:51:04.068 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:51:04.079 | WARNING  | fullon_ohlcv_service.daemon | 145 | Symbol initialization failed - continuing anyway symbol=BTC/USDT exchange=binance
2025-10-14 02:51:04.081 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 02:51:04.082 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:51:04.081 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-13 16:00:00.000000', 49076.22, 49575.14072416712, 48584.29135491872, 49013.96894176996, 2122.7163), ('2025-10-13 17:00:00.000000', 43061.45, 43757.1018358621, 42373.371696617396, 42454.533747752386, 7432.4846), ('2025-10-13 18:00:00.000000', 32705.49, 32828.6218713545, 32365.433159857872, 32717.526862514755, 7746.0492), ('2025-10-13 19:00:00.000000', 49510.86, 50231.306913118904, 49493.430740749245, 49609.55295192628, 9287.3825), ('2025-10-13 20:00:00.000000', 37168.44, 38042.946059051596, 36570.824504244636, 36918.05837394451, 6832.3828), ('2025-10-13 21:00:00.000000', 47168.57, 47827.06686057858, 46874.37999187671, 47447.96344524493, 1438.0484), ('2025-10-13 22:00:00.000000', 41544.48, 41722.83516841646, 40806.18691370739, 41497.51766938022, 1529.0346), ('2025-10-13 23:00:00.000000', 30205.85, 30214.35790205971, 29731.433806602436, 29767.98230012775, 8693.7603), ('2025-10-14 00:00:00.000000', 39472.83, 40301.81092123544, 39273.07169722356, 39689.12364720933, 337.7424), ('2025-10-14 01:00:00.000000', 43035.11, 43413.47258475261, 42477.95107187781, 43267.58631040439, 6025.9343)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:51:04.080 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:51:04.081 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 02:51:04.082 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:51:04.082 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 02:51:04.083 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 02:51:04.083 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:51:04.086 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:51:04.099 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 02:51:04.099 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:51:04.116 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 02:50:44.091933', 34512.89, 5.76568688, 'buy', 'market'), ('2025-10-14 02:50:45.091933', 38911.96, 3.34754686, 'buy', 'market'), ('2025-10-14 02:50:46.091933', 34246.0, 0.66666954, 'sell', 'limit'), ('2025-10-14 02:50:47.091933', 46148.69, 9.24453829, 'sell', 'market'), ('2025-10-14 02:50:48.091933', 30675.53, 9.11746111, 'sell', 'market'), ('2025-10-14 02:50:49.091933', 31497.48, 3.41446195, 'buy', 'limit'), ('2025-10-14 02:50:50.091933', 32289.17, 2.85656093, 'sell', 'limit'), ('2025-10-14 02:50:51.091933', 37638.38, 8.46430011, 'sell', 'limit'), ('2025-10-14 02:50:52.091933', 46317.31, 8.94243362, 'sell', 'limit'), ('2025-10-14 02:50:53.091933', 37981.39, 8.27826563, 'sell', 'limit'), ('2025-10-14 02:50:54.091933', 38886.77, 9.03077317, 'buy', 'limit'), ('2025-10-14 02:50:55.091933', 35211.71, 9.13655201, 'buy', 'limit'), ('2025-10-14 02:50:56.091933', 47111.02, 5.96271936, 'sell', 'market'), ('2025-10-14 02:50:57.091933', 33931.26, 6.29591061, 'sell', 'market'), ('2025-10-14 02:50:58.091933', 31514.05, 3.18159175, 'buy', 'limit'), ('2025-10-14 02:50:59.091933', 49655.47, 6.83547559, 'buy', 'limit'), ('2025-10-14 02:51:00.091933', 49334.27, 1.04689749, 'sell', 'limit'), ('2025-10-14 02:51:01.091933', 44945.62, 6.88645121, 'sell', 'market'), ('2025-10-14 02:51:02.091933', 44221.7, 5.03818984, 'buy', 'market'), ('2025-10-14 02:51:03.091933', 39607.98, 0.10611543, 'buy', 'limit')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:51:04.115 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=2 total_symbols=4
2025-10-14 02:51:04.132 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 02:51:04.138 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:51:04.139 | INFO     | fullon_ohlcv_service.trade.historic_collector | 215 | Exchange has native OHLCV support - skipping trade collection exchange=kraken symbol_count=1
2025-10-14 02:51:04.145 | WARNING  | fullon_ohlcv_service.config.database_config | 60 | Category exchange not found for cat_ex_id 1
2025-10-14 02:51:04.145 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 02:51:04.146 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:51:00.000000', 31680.56, 32389.5697556243, 31643.60371704614, 32325.914293705762, 5340.6481)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:51:04.157 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:51:04.157 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:51:04.158 | INFO     | fullon_cache.event_loop | 134 | Event loop configured: uvloop
2025-10-14 02:51:04.159 | INFO     | fullon_cache.connection | 121 | uvloop configured for optimal Redis performance
2025-10-14 02:51:04.163 | WARNING  | fullon_ohlcv_service.config.database_config | 60 | Category exchange not found for cat_ex_id 1
2025-10-14 02:51:04.164 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 02:51:04.176 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 02:51:04.178 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:51:04.179 | INFO     | fullon_ohlcv_service.trade.historic_collector | 215 | Exchange has native OHLCV support - skipping trade collection exchange=kraken symbol_count=1
2025-10-14 02:51:04.197 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:51:04.201 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:51:04.202 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:51:04.202 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:51:04.203 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:51:04.204 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 02:51:04.198 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 02:51:04.200 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:51:04.201 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 02:51:04.202 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 02:51:04.203 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:51:04.203 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:51:04.213 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 02:51:04.221 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:51:04.221 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:51:04.223 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 02:51:04.225 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:51:04.226 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 200 | Failed to get REST handler for exchange exchange=kraken error=Handler creation failed
2025-10-14 02:51:04.254 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:51:04.254 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:51:04.255 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 353 | Error collecting batch for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 02:51:04.255 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 242 | Historical collection failed for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 02:51:04.257 | WARNING  | fullon_ohlcv_service.ohlcv.historic_collector | 436 | Skipping candle with None values raw_candle=[1640995260000, None, 51500, 49500, 51000, 150]
2025-10-14 02:51:04.272 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:51:04.272 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 02:51:04.275 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 241 | Historical collection completed for symbol symbol=kraken:BTC/USD candles_collected=0
2025-10-14 02:51:04.277 | WARNING  | fullon_ohlcv_service.ohlcv.live_collector | 42 | Live collection already running
2025-10-14 02:51:04.283 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 74 | Stopping live OHLCV collection
2025-10-14 02:51:04.291 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 86 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 02:51:04.299 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:51:04.296 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:51:04.305 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 02:51:04.308 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 241 | Historical collection completed for symbol symbol=kraken:BTC/USD candles_collected=0
2025-10-14 02:51:04.306 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:51:04.309 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:51:04.317 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:51:04.318 | WARNING  | fullon_ohlcv_service.daemon | 230 | Error stopping collector during cleanup error=Stop failed
2025-10-14 02:51:04.319 | WARNING  | fullon_ohlcv_service.daemon | 242 | Failed to update ProcessCache during cleanup error=Cache update failed
2025-10-14 02:51:04.319 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:51:04.336 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:51:04.338 | WARNING  | fullon_ohlcv_service.daemon | 75 | No symbols found in database - nothing to collect
2025-10-14 02:51:04.338 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:51:04.338 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:51:04.342 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:51:04.343 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 02:51:04.344 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 364 | Error collecting batch for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 02:51:04.345 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 235 | Historical collection failed for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 02:51:04.391 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 291 | Symbol already collecting symbol_key=binance:BTC/USDT
2025-10-14 02:51:04.400 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=ETH/USDT
2025-10-14 02:51:04.401 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 353 | Added symbol to collector symbol=ETH/USDT exchange=binance
2025-10-14 02:51:04.410 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 356 | Creating new handler exchange=binance symbol=BTC/USDT
2025-10-14 02:51:04.427 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=BTC/USDT
2025-10-14 02:51:04.429 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 353 | Added symbol to collector symbol=BTC/USDT exchange=binance
2025-10-14 02:51:04.436 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=BTC/USDT
2025-10-14 02:51:04.437 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 317 | Exchange needs trades for OHLCV, skipping exchange=binance symbol=BTC/USDT
2025-10-14 02:51:04.442 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:04.446 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:04.451 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:04.455 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:51:04.456 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 02:51:04.457 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:51:04.457 | ERROR    | fullon_ohlcv_service.daemon | 119 | Daemon error error=OHLCV collection failed
2025-10-14 02:51:04.458 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:51:04.458 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:51:04.459 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:51:04.459 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:51:04.476 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:51:04.468 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:04.477 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:04.478 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 122 | Exchange requires trade collection instead of OHLCV - skipping OHLCV subscription exchange=binance symbol_count=1
2025-10-14 02:51:04.488 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:51:04.488 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 122 | Exchange requires trade collection instead of OHLCV - skipping OHLCV subscription exchange=binance symbol_count=1
2025-10-14 02:51:04.493 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:04.497 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:51:04.497 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 132 | Exchange supports native OHLCV - proceeding with subscription exchange=binance symbol_count=1
2025-10-14 02:51:04.499 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:04.504 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:04.505 | INFO     | fullon_ohlcv_service.trade.batcher | 105 | Batch processing started
2025-10-14 02:51:04.508 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 166 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 02:51:04.508 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 183 | Finished subscribing to OHLCV exchange=binance symbol_count=1
2025-10-14 02:51:04.511 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:04.512 | INFO     | fullon_ohlcv_service.trade.batcher | 87 | Symbol unregistered from batch processing exchange=kraken symbol=ETH/USD remaining_symbols=2
2025-10-14 02:51:04.522 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:04.527 | INFO     | fullon_ohlcv_service.trade.batcher | 105 | Batch processing started
2025-10-14 02:51:04.534 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:04.541 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:04.547 | ERROR    | fullon_ohlcv_service.ohlcv.live_collector | 238 | Error processing OHLCV exchange=binance symbol=BTC/USDT error=not enough values to unpack (expected 6, got 1)
2025-10-14 02:51:04.552 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:51:04.558 | INFO     | fullon_ohlcv_service.trade.batcher | 257 | Batch cycle completed - no trades to process total_symbols=2 duration_seconds=0.0
2025-10-14 02:51:04.592 | INFO     | fullon_ohlcv_service.trade.historic_collector | 169 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 02:51:04.599 | WARNING  | fullon_ohlcv_service.trade.historic_collector | 69 | Historical collection already running
2025-10-14 02:51:04.617 | INFO     | fullon_ohlcv_service.daemon | 171 | Starting two-phase collection for single symbol symbol=BTC/USDC exchange=kraken
2025-10-14 02:51:04.618 | INFO     | fullon_ohlcv_service.daemon | 180 | Phase 1: Starting historic collection
2025-10-14 02:51:04.620 | INFO     | fullon_ohlcv_service.daemon | 188 | Phase 1: Historic collection completed
2025-10-14 02:51:04.618 | INFO     | fullon_ohlcv_service.trade.historic_collector | 73 | Starting historical trade collection
2025-10-14 02:51:04.620 | WARNING  | fullon_ohlcv_service.trade.historic_collector | 92 | No admin exchange found for collection exchange=binance
2025-10-14 02:51:04.620 | INFO     | fullon_ohlcv_service.daemon | 197 | Phase 2: Starting live streaming
2025-10-14 02:51:04.622 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDC
2025-10-14 02:51:04.621 | INFO     | fullon_ohlcv_service.trade.historic_collector | 115 | Historical collection completed total_symbols=0 total_trades=0
2025-10-14 02:51:04.624 | WARNING  | fullon_ohlcv_service.trade.live_collector | 43 | Live collection already running
2025-10-14 02:51:04.628 | INFO     | fullon_ohlcv_service.trade.historic_collector | 73 | Starting historical trade collection
2025-10-14 02:51:04.629 | INFO     | fullon_ohlcv_service.trade.live_collector | 75 | Stopping live trade collection
2025-10-14 02:51:04.629 | INFO     | fullon_ohlcv_service.trade.historic_collector | 115 | Historical collection completed total_symbols=0 total_trades=0
2025-10-14 02:51:04.640 | INFO     | fullon_ohlcv_service.trade.live_collector | 94 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 02:51:04.651 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:51:04.653 | WARNING  | fullon_ohlcv_service.trade.live_collector | 166 | Failed to subscribe to trades exchange=binance symbol=BTC/USDT error=Subscription failed
2025-10-14 02:51:04.653 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 02:51:04.675 | WARNING  | fullon_ohlcv_service.trade.live_collector | 192 | Trade object missing symbol attribute exchange=binance trade_obj=<Mock id='134992933796032'>
2025-10-14 02:51:04.689 | ERROR    | fullon_ohlcv_service.trade.live_collector | 225 | Error processing trade exchange=binance error=Cache error
2025-10-14 02:51:04.693 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=1 total_symbols=1
2025-10-14 02:51:04.713 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:51:04.714 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 02:51:04.716 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 02:51:04.728 | WARNING  | fullon_ohlcv_service.ohlcv.historic_collector | 68 | Historical collection already running
2025-10-14 02:51:04.730 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:51:04.731 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 02:51:04.733 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol kraken:BTC/USDC'
2025-10-14 02:51:04.741 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 169 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 02:51:04.770 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 72 | Starting historical OHLCV collection
2025-10-14 02:51:04.771 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 114 | Historical collection completed total_symbols=0 total_candles=0
2025-10-14 02:51:04.772 | ERROR    | fullon_ohlcv.repositories.ohlcv.base_repository | 426 | Failed to create hypertable for kraken.btc_usdc_trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedFunctionError'>: function create_hypertable(regclass, unknown, if_not_exists => boolean) does not exist
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[SQL: 
                    SELECT create_hypertable(
                        'kraken.btc_usdc_trades'::regclass,
                        'timestamp',
                        if_not_exists => TRUE
                    )
                ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:51:04.775 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 40 | Failed to initialize symbol kraken:BTC/USDC
2025-10-14 02:51:04.775 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 95 | Failed to initialize symbol kraken:BTC/USDC
2025-10-14 02:51:04.776 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 0/1 successful
2025-10-14 02:51:04.776 | WARNING  | fullon_ohlcv_service.daemon | 145 | Symbol initialization failed - continuing anyway symbol=BTC/USDC exchange=kraken
2025-10-14 02:51:04.776 | ERROR    | fullon_ohlcv_service.daemon | 207 | Daemon in inconsistent state - cannot proceed
2025-10-14 02:51:04.786 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 72 | Starting historical OHLCV collection
2025-10-14 02:51:04.786 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=binance symbol_count=1
2025-10-14 02:51:04.787 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 199 | Failed to get REST handler for exchange exchange=binance error=object MagicMock can't be used in 'await' expression
2025-10-14 02:51:04.788 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 114 | Historical collection completed total_symbols=0 total_candles=0
2025-10-14 02:51:04.871 | INFO     | fullon_ohlcv_service.daemon | 171 | Starting two-phase collection for single symbol symbol=BTC/USDT exchange=binance
2025-10-14 02:51:04.872 | INFO     | fullon_ohlcv_service.daemon | 180 | Phase 1: Starting historic collection
2025-10-14 02:51:04.873 | INFO     | fullon_ohlcv_service.daemon | 188 | Phase 1: Historic collection completed
2025-10-14 02:51:04.874 | INFO     | fullon_ohlcv_service.daemon | 197 | Phase 2: Starting live streaming
2025-10-14 02:51:04.874 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:51:04.979 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 02:51:04.979 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:55:49.608 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:55:50.784 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:55:50.828 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:55:50.874 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:55:50.911 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:55:51.572 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 02:55:51.579 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 02:55:51.610 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 02:55:51.676 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 02:55:52.069 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 02:55:52.070 | INFO     | fullon_ohlcv_service.utils.add_symbols | 37 | Successfully initialized symbol binance:BTC/USDT
2025-10-14 02:55:52.075 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 02:55:52.076 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 44 | Error initializing symbol binance:BTC/USDT: Init failed
2025-10-14 02:55:52.077 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 02:55:52.078 | INFO     | fullon_ohlcv_service.utils.add_symbols | 131 | Found 2 symbols for exchange binance
2025-10-14 02:55:52.081 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 02:55:52.078 | INFO     | fullon_ohlcv_service.utils.add_symbols | 143 | Exchange binance initialization: 1/2 successful
2025-10-14 02:55:52.081 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 44 | Error initializing symbol binance:BTC/USDT: Repository creation failed
2025-10-14 02:55:52.086 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 02:55:52.087 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 147 | Error initializing symbols for exchange binance: Database error
2025-10-14 02:55:52.087 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:55:52.088 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 2 symbols to initialize
2025-10-14 02:55:52.088 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 2/2 successful
2025-10-14 02:55:52.098 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:55:52.099 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 02:55:52.100 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/1 successful
2025-10-14 02:55:52.107 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:55:52.108 | WARNING  | fullon_ohlcv_service.utils.add_symbols | 72 | No symbols found
2025-10-14 02:55:52.110 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:55:52.111 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=2
2025-10-14 02:55:52.112 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:55:52.112 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 02:55:52.113 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 02:55:52.113 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:55:52.114 | INFO     | fullon_ohlcv_service.trade.live_collector | 75 | Stopping live trade collection
2025-10-14 02:55:52.114 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.114 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:55:52.114 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:55:52.114 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 2 symbols to initialize
2025-10-14 02:55:52.116 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 95 | Failed to initialize symbol <MagicMock name='mock.exchange_name' id='130776789340512'>:ETH/USDT
2025-10-14 02:55:52.116 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/2 successful
2025-10-14 02:55:52.121 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:55:52.122 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 102 | Error during bulk symbol initialization: Database connection failed
2025-10-14 02:55:52.132 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:55:52.132 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 02:55:52.132 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/1 successful
2025-10-14 02:55:52.140 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 02:55:52.141 | INFO     | fullon_ohlcv_service.utils.add_symbols | 131 | Found 2 symbols for exchange binance
2025-10-14 02:55:52.141 | INFO     | fullon_ohlcv_service.utils.add_symbols | 143 | Exchange binance initialization: 2/2 successful
2025-10-14 02:55:52.148 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 02:55:52.148 | WARNING  | fullon_ohlcv_service.utils.add_symbols | 128 | No symbols found for exchange binance
2025-10-14 02:55:52.220 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:55:52.221 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 02:55:52.223 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:55:52.224 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 02:55:52.225 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 02:55:52.225 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:55:52.226 | WARNING  | fullon_ohlcv_service.daemon | 230 | Error stopping collector during cleanup error=object MagicMock can't be used in 'await' expression
2025-10-14 02:55:52.226 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:55:52.260 | INFO     | fullon_ohlcv_service.daemon | 155 | Symbol already collecting symbol=BTC/USDT
2025-10-14 02:55:52.268 | INFO     | fullon_ohlcv_service.daemon | 159 | Symbol already collecting symbol=BTC/USDT
2025-10-14 02:55:52.277 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 02:55:52.277 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:55:52.289 | WARNING  | fullon_ohlcv_service.daemon | 145 | Symbol initialization failed - continuing anyway symbol=BTC/USDT exchange=binance
2025-10-14 02:55:52.290 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 02:55:52.291 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:55:52.300 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 02:55:52.300 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:55:52.311 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=2 total_symbols=4
2025-10-14 02:55:52.321 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 02:55:52.331 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-13 02:00:00.000000', 50000.0, 50269.46, 49653.05, 50020.23, 1014.0206), ('2025-10-13 03:00:00.000000', 50020.23, 50089.52, 49741.65, 49998.24, 1261.9057), ('2025-10-13 04:00:00.000000', 49998.24, 50475.18, 49616.75, 50365.91, 1282.4237), ('2025-10-13 05:00:00.000000', 50365.91, 50734.49, 50033.97, 50651.83, 573.0985), ('2025-10-13 06:00:00.000000', 50651.83, 50996.6, 50503.38, 50639.25, 604.3255), ('2025-10-13 07:00:00.000000', 50639.25, 50762.71, 50304.33, 50447.55, 589.6137), ('2025-10-13 08:00:00.000000', 50447.55, 50839.59, 49958.08, 50123.78, 836.4384), ('2025-10-13 09:00:00.000000', 50123.78, 50314.79, 49639.57, 49984.05, 821.5494), ('2025-10-13 10:00:00.000000', 49984.05, 50274.43, 49638.4, 50264.77, 1580.8817), ('2025-10-13 11:00:00.000000', 50264.77, 50698.43, 50063.43, 50650.97, 907.8081), ('2025-10-13 12:00:00.000000', 50650.97, 50945.16, 50185.77, 50518.33, 872.3533), ('2025-10-13 13:00:00.000000', 50518.33, 50988.73, 50381.62, 50805.07, 1479.2124), ('2025-10-13 14:00:00.000000', 50805.07, 51045.56, 50737.31, 50775.56, 1301.6796), ('2025-10-13 15:00:00.000000', 50775.56, 51072.96, 50309.53, 51041.14, 691.446), ('2025-10-13 16:00:00.000000', 51041.14, 51348.89, 50817.17, 50930.19, 1110.7812), ('2025-10-13 17:00:00.000000', 50930.19, 51256.34, 50705.45, 51032.73, 1306.286), ('2025-10-13 18:00:00.000000', 51032.73, 51043.83, 50914.47, 51004.35, 653.5661), ('2025-10-13 19:00:00.000000', 51004.35, 51290.55, 50875.45, 51265.51, 598.1322), ('2025-10-13 20:00:00.000000', 51265.51, 51610.25, 51131.44, 51525.29, 1186.2652), ('2025-10-13 21:00:00.000000', 51525.29, 51536.62, 51523.66, 51527.22, 670.2302), ('2025-10-13 22:00:00.000000', 51527.22, 51819.34, 51195.26, 51574.51, 1139.8828), ('2025-10-13 23:00:00.000000', 51574.51, 51749.47, 51183.76, 51223.85, 1320.2817), ('2025-10-14 00:00:00.000000', 51223.85, 51254.17, 50723.48, 50751.24, 792.064), ('2025-10-14 01:00:00.000000', 50751.24, 51227.95, 50284.53, 50410.77, 941.726)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:55:52.333 | WARNING  | fullon_ohlcv_service.config.database_config | 60 | Category exchange not found for cat_ex_id 1
2025-10-14 02:55:52.333 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 02:55:52.337 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:55:52.338 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 02:55:52.339 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:55:52.340 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 02:55:52.340 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 02:55:52.341 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:55:52.342 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:55:52.349 | WARNING  | fullon_ohlcv_service.config.database_config | 60 | Category exchange not found for cat_ex_id 1
2025-10-14 02:55:52.349 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 02:55:52.350 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 01:55:52.297054', 45000.0, 1.1054340091930173, 'sell', 'market'), ('2025-10-14 01:55:56.726929', 45050.144641734885, 1.1568291971416533, 'buy', 'market'), ('2025-10-14 01:55:57.010808', 44985.870600535156, 0.6823225680662064, 'sell', 'market'), ('2025-10-14 01:56:10.259590', 45005.733718346404, 0.37913024928529027, 'buy', 'market'), ('2025-10-14 01:56:30.638374', 44959.279103224784, 1.0170695711768662, 'sell', 'limit'), ('2025-10-14 01:56:32.709769', 44896.85327612237, 1.5177225607916167, 'sell', 'market'), ('2025-10-14 01:56:20.317192', 44895.234324185505, 1.2920598693616903, 'sell', 'market'), ('2025-10-14 01:56:38.571604', 44975.04148450702, 0.3216673552599691, 'sell', 'market'), ('2025-10-14 01:56:18.343382', 44996.74324293577, 1.4303853995610665, 'buy', 'market'), ('2025-10-14 01:55:59.273422', 45122.39017116451, 1.954643551721189, 'buy', 'market'), ('2025-10-14 01:56:31.639434', 45129.6251988919, 1.5388615871743507, 'sell', 'limit'), ('2025-10-14 01:57:34.822312', 45123.47504545645, 0.271161186678374, 'buy', 'market'), ('2025-10-14 01:57:30.725698', 45108.025428607, 1.864832233522704, 'sell', 'market'), ('2025-10-14 01:57:09.003463', 45103.280204391434, 0.6690257010582037, 'sell', 'market'), ('2025-10-14 01:56:48.899124', 45089.13490180344, 1.4758788213115757, 'buy', 'market'), ('2025-10-14 01:56:34.850809', 45076.24200749963, 0.7366085574897473, 'sell', 'market'), ('2025-10-14 01:58:12.527902', 45049.03582060337, 1.3513691515101214, 'buy', 'limit'), ('2025-10-14 01:56:13.477218', 44951.90412012582, 0.4147624201159729, 'sell', 'market'), ('2025-10-14 01:57:00.850666', 44947.269633461394, 0.8703712992679153, 'sell', 'market'), ('2025-10-14 01:58:57.508123', 44988.584728308815, 0.630048221745251, 'buy', 'market'), ('2025-10-14 01:57:58.882454', 44943.29421794315, 1.5211924477923584, 'sell', 'limit'), ('2025-10-14 01:58:00.121618', 45039.32397093528, 1.7268249991746694, 'sell', 'market'), ('2025-10-14 01:56:29.287392', 45135.74521447434, 0.0610924417506396, 'buy', 'market'), ('2025-10-14 01:57:35.332224', 45060.17783761512, 1.9924639605470424, 'sell', 'market'), ('2025-10-14 01:57:16.379278', 45068.82142363564, 1.5573523607706363, 'buy', 'market'), ('2025-10-14 01:59:34.066629', 45010.92120688155, 1.7674286301696769, 'sell', 'market'), ('2025-10-14 02:00:09.255730', 44955.770500388084, 1.6684220958335854, 'sell', 'market'), ('2025-10-14 02:00:02.298964', 45037.955603287795, 0.5561428582237802, 'sell', 'market'), ('2025-10-14 01:58:24.781666', 45094.20456678434, 1.1212901810378748, 'sell', 'market'), ('2025-10-14 01:58:48.276188', 45121.86557760255, 0.8817885629215142, 'buy', 'market'), ('2025-10-14 01:59:16.613884', 45086.87162067841, 0.2591396388939199, 'sell', 'market'), ('2025-10-14 01:59:59.181271', 45059.945488069476, 0.2851833059300288, 'sell', 'market'), ('2025-10-14 01:59:28.932414', 45079.21128266745, 0.6605853065416548, 'buy', 'market'), ('2025-10-14 02:00:25.885798', 45104.05190750991, 1.491235089825766, 'sell', 'market'), ('2025-10-14 02:01:08.995698', 45163.65859578857, 0.6207278199604068, 'buy', 'market'), ('2025-10-14 01:58:29.018479', 45191.28370745426, 0.44353475499464146, 'buy', 'market'), ('2025-10-14 01:56:35.059834', 45146.08529892789, 1.0517189567777743, 'sell', 'market'), ('2025-10-14 02:00:51.669382', 45180.077722533, 0.9299854654326184, 'buy', 'market'), ('2025-10-14 02:02:10.699002', 45179.86075134278, 0.18807292975305476, 'buy', 'limit'), ('2025-10-14 01:58:20.956630', 45263.82855058613, 0.7359383581886252, 'sell', 'market'), ('2025-10-14 02:00:46.939694', 45272.27039315707, 1.7547855927331144, 'sell', 'market'), ('2025-10-14 02:01:28.940059', 45326.25030090578, 0.6780911600612204, 'buy', 'market'), ('2025-10-14 02:00:02.907652', 45335.77614032653, 1.7522791976570549, 'buy', 'limit'), ('2025-10-14 01:56:22.026781', 45313.790934410776, 0.2834159590175306, 'sell', 'market'), ('2025-10-14 01:59:33.824206', 45312.57921660631, 0.1345923625420528, 'sell', 'market'), ('2025-10-14 02:02:38.974069', 45272.44254236134, 0.4748776560711467, 'sell', 'limit'), ('2025-10-14 01:57:55.341856', 45284.957758116805, 1.2290365043344829, 'buy', 'market'), ('2025-10-14 02:01:00.611743', 45354.30894335391, 1.9037927266309942, 'buy', 'market'), ('2025-10-14 02:01:52.966894', 45319.91834454608, 0.9967209941448897, 'sell', 'market'), ('2025-10-14 02:02:09.894974', 45315.10322468933, 0.6722550054052185, 'sell', 'market'), ('2025-10-14 01:56:05.218054', 45395.022566831154, 0.14850187207627263, 'buy', 'market'), ('2025-10-14 01:59:41.688169', 45368.78958085833, 1.8106809987643824, 'buy', 'market'), ('2025-10-14 02:01:27.857734', 45401.35848026717, 1.4203323276282271, 'buy', 'limit'), ('2025-10-14 02:03:54.998105', 45398.260316305066, 0.6248650020921344, 'buy', 'market'), ('2025-10-14 02:01:29.904406', 45373.2647863015, 0.6954869354677329, 'sell', 'market'), ('2025-10-14 02:03:48.824424', 45420.68999852199, 0.1805324926449878, 'buy', 'market'), ('2025-10-14 01:57:05.982582', 45420.24604479396, 0.6603403551270492, 'sell', 'limit'), ('2025-10-14 01:58:32.112514', 45390.40205942712, 0.40213489279247283, 'sell', 'market'), ('2025-10-14 02:01:43.841318', 45395.1177340405, 1.477373626368636, 'buy', 'market'), ('2025-10-14 02:05:00.547769', 45345.215568598294, 1.5236773767584741, 'sell', 'market'), ('2025-10-14 01:58:29.977234', 45293.63794549282, 0.2959703870711303, 'buy', 'market'), ('2025-10-14 01:56:53.846786', 45272.020217940786, 1.6421781119972536, 'sell', 'limit'), ('2025-10-14 02:01:44.324126', 45218.54281274751, 1.0135273084208607, 'sell', 'limit'), ('2025-10-14 02:01:24.453655', 45206.99132804475, 1.8222731944855768, 'sell', 'market'), ('2025-10-14 02:01:24.509982', 45201.77459408435, 0.7565182387163674, 'sell', 'market'), ('2025-10-14 01:56:08.686999', 45325.73200592563, 0.6121142858155704, 'buy', 'market'), ('2025-10-14 02:04:57.288094', 45299.94681885672, 1.9391966516388386, 'sell', 'market'), ('2025-10-14 02:02:51.680807', 45289.172801131244, 0.6896667645666847, 'sell', 'limit'), ('2025-10-14 01:57:45.131426', 45317.02452614953, 1.6421213156767362, 'buy', 'market'), ('2025-10-14 02:06:48.530938', 45346.44568144922, 0.9023416966179592, 'sell', 'market'), ('2025-10-14 02:00:15.964164', 45364.164066910824, 0.8738514442973624, 'buy', 'market'), ('2025-10-14 01:57:08.467203', 45357.70220518858, 1.9938306008683089, 'sell', 'market'), ('2025-10-14 01:57:40.905166', 45332.39137788292, 1.7620536622769796, 'buy', 'market'), ('2025-10-14 02:07:36.458923', 45274.22087948311, 0.45507275237799194, 'sell', 'market'), ('2025-10-14 01:59:38.463772', 45279.73093328079, 1.2543905036742413, 'sell', 'market'), ('2025-10-14 02:00:23.760979', 45293.060733400955, 1.5422385742724678, 'buy', 'market'), ('2025-10-14 01:56:55.165926', 45318.55490520098, 0.16436220929800843, 'buy', 'limit'), ('2025-10-14 01:58:45.858596', 45262.4123037294, 1.3882792154643409, 'sell', 'market'), ('2025-10-14 02:03:33.775864', 45225.32684756761, 1.0196947928662727, 'sell', 'limit'), ('2025-10-14 02:05:25.522002', 45271.40128846326, 0.5741422923919663, 'sell', 'market'), ('2025-10-14 01:56:02.967054', 45240.70858234572, 0.5544097319099032, 'sell', 'market'), ('2025-10-14 02:01:43.682587', 45232.05235012758, 1.5034278439975426, 'sell', 'market'), ('2025-10-14 01:58:46.533524', 45323.635361384906, 0.23861170643275953, 'buy', 'market'), ('2025-10-14 02:01:10.220420', 45233.61599022147, 1.695067205320011, 'sell', 'limit'), ('2025-10-14 02:06:19.867942', 45231.812707964484, 0.7422104182672721, 'sell', 'market'), ('2025-10-14 02:00:53.534334', 45163.716517977715, 1.3324055535150863, 'sell', 'market'), ('2025-10-14 02:04:58.515906', 45089.175995342965, 0.09886337813982346, 'sell', 'market'), ('2025-10-14 02:02:28.045612', 45143.528129729835, 0.6178992944741009, 'buy', 'market'), ('2025-10-14 02:03:24.262414', 45148.64825634135, 1.0658146382603753, 'buy', 'limit'), ('2025-10-14 01:59:39.448817', 45076.638879396494, 0.9434917566191408, 'buy', 'market'), ('2025-10-14 02:02:06.864724', 45167.57124126018, 0.8714935277878213, 'buy', 'market'), ('2025-10-14 01:59:41.006171', 45182.844020193785, 1.5099155728974463, 'buy', 'market'), ('2025-10-14 01:58:01.448954', 45155.042625739145, 1.4974273672778675, 'sell', 'market'), ('2025-10-14 02:04:09.339274', 45120.89166309233, 1.2081808184174827, 'sell', 'market'), ('2025-10-14 02:05:34.452590', 45156.39242348884, 1.7949133552174015, 'buy', 'market'), ('2025-10-14 02:03:01.302709', 45296.77821194356, 1.4171111512888925, 'buy', 'market'), ('2025-10-14 02:07:50.059870', 45334.56714841821, 0.26394424191378474, 'buy', 'market'), ('2025-10-14 02:00:41.128328', 45301.10543455632, 1.137530472279598, 'sell', 'market'), ('2025-10-14 02:07:05.963656', 45331.362185415535, 1.8040213088402488, 'buy', 'market'), ('2025-10-14 02:11:27.116137', 45351.292486521874, 1.7323127039599953, 'buy', 'market')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:55:52.372 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:55:00.000000', 44791.9, 45084.47930430478, 44562.26735811969, 45043.480953457576, 376.4386)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:55:52.381 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:55:00.000000', 44194.59, 44454.67212724584, 44185.43648649052, 44317.83008870808, 3361.4889)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:55:52.383 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:55:00.000000', 44312.45, 44684.68345744663, 44298.249774336145, 44330.94162418721, 5663.5524)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:55:52.386 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:55:00.000000', 47031.57, 47423.690967364426, 46085.58176508671, 46579.78942273294, 2227.6013)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:55:52.391 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 02:55:52.382667', 41361.6, 9.75602465, 'sell', 'limit')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:55:52.428 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-13 16:00:00.000000', 35862.66, 35966.138368450054, 35778.31531029916, 35818.764374146405, 7509.8404), ('2025-10-13 17:00:00.000000', 30130.24, 30581.69357163231, 29474.482346567715, 29863.682599415555, 2974.9568), ('2025-10-13 18:00:00.000000', 34639.19, 35632.02220728295, 34311.98244022334, 35256.068798235494, 9380.0051), ('2025-10-13 19:00:00.000000', 35876.76, 36429.146999439225, 35213.23968377641, 35936.82855053614, 6135.925), ('2025-10-13 20:00:00.000000', 41945.6, 42943.68740735167, 41516.163648871865, 41705.975515530554, 8421.5181), ('2025-10-13 21:00:00.000000', 44046.89, 44838.416846962384, 43525.19432639696, 44613.43443896248, 3694.6812), ('2025-10-13 22:00:00.000000', 39491.45, 40063.07504209489, 39193.153522724315, 39934.24404790145, 3594.2698), ('2025-10-13 23:00:00.000000', 48247.82, 49015.995296195346, 47782.126334942885, 48772.9128448088, 1645.8913), ('2025-10-14 00:00:00.000000', 49028.82, 49578.66014821033, 48361.26349325806, 48399.65007388266, 586.2552), ('2025-10-14 01:00:00.000000', 39775.92, 40541.993125471105, 39689.50106827164, 39836.74780621832, 8224.8825)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:55:52.453 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:55:52.454 | INFO     | fullon_ohlcv_service.trade.historic_collector | 215 | Exchange has native OHLCV support - skipping trade collection exchange=kraken symbol_count=1
2025-10-14 02:55:52.454 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 02:55:32.437894', 42718.44, 0.31648503, 'sell', 'limit'), ('2025-10-14 02:55:33.437894', 42594.43, 3.38537342, 'buy', 'limit'), ('2025-10-14 02:55:34.437894', 46906.2, 8.09738997, 'buy', 'market'), ('2025-10-14 02:55:35.437894', 34315.56, 7.95293795, 'buy', 'market'), ('2025-10-14 02:55:36.437894', 48807.43, 9.71962327, 'buy', 'market'), ('2025-10-14 02:55:37.437894', 44093.45, 1.83710727, 'buy', 'market'), ('2025-10-14 02:55:38.437894', 45794.38, 2.47934126, 'sell', 'limit'), ('2025-10-14 02:55:39.437894', 31903.64, 4.37246839, 'buy', 'limit'), ('2025-10-14 02:55:40.437894', 31294.32, 5.81923913, 'buy', 'limit'), ('2025-10-14 02:55:41.437894', 42552.32, 0.64029749, 'sell', 'market'), ('2025-10-14 02:55:42.437894', 31815.48, 3.11662448, 'buy', 'market'), ('2025-10-14 02:55:43.437894', 33867.51, 6.47526477, 'sell', 'limit'), ('2025-10-14 02:55:44.437894', 38629.67, 8.32762226, 'buy', 'market'), ('2025-10-14 02:55:45.437894', 42338.75, 8.73129715, 'buy', 'limit'), ('2025-10-14 02:55:46.437894', 44437.74, 6.89383027, 'sell', 'market'), ('2025-10-14 02:55:47.437894', 43122.7, 7.03923794, 'buy', 'limit'), ('2025-10-14 02:55:48.437894', 45309.41, 2.86832916, 'buy', 'limit'), ('2025-10-14 02:55:49.437894', 44600.64, 9.24521488, 'buy', 'market'), ('2025-10-14 02:55:50.437894', 41513.78, 5.4310161, 'buy', 'market'), ('2025-10-14 02:55:51.437894', 48649.11, 2.93957116, 'sell', 'market')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:55:52.448 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:55:52.449 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 02:55:52.450 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:55:52.452 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 02:55:52.453 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 02:55:52.454 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:55:52.458 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:55:52.472 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:55:00.000000', 48570.59, 49169.38544869532, 48062.96855774487, 49145.13732487839, 2204.3204)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:55:52.472 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:55:52.472 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:55:52.474 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 02:55:52.491 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:55:52.492 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:55:52.493 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 02:55:52.500 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:55:52.500 | INFO     | fullon_ohlcv_service.trade.historic_collector | 215 | Exchange has native OHLCV support - skipping trade collection exchange=kraken symbol_count=1
2025-10-14 02:55:52.511 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:55:52.511 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:55:52.513 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 353 | Error collecting batch for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 02:55:52.513 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 242 | Historical collection failed for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 02:55:52.515 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:55:52.515 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:55:52.516 | INFO     | fullon_cache.event_loop | 134 | Event loop configured: uvloop
2025-10-14 02:55:52.516 | INFO     | fullon_cache.connection | 121 | uvloop configured for optimal Redis performance
2025-10-14 02:55:52.529 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 02:55:52.536 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:55:52.537 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 02:55:52.538 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 241 | Historical collection completed for symbol symbol=kraken:BTC/USD candles_collected=0
2025-10-14 02:55:52.545 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:55:52.546 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:55:52.556 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 02:55:52.554 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:55:52.554 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 02:55:52.556 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 241 | Historical collection completed for symbol symbol=kraken:BTC/USD candles_collected=0
2025-10-14 02:55:52.555 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:55:52.558 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:55:52.566 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:55:52.568 | WARNING  | fullon_ohlcv_service.daemon | 230 | Error stopping collector during cleanup error=Stop failed
2025-10-14 02:55:52.569 | WARNING  | fullon_ohlcv_service.daemon | 242 | Failed to update ProcessCache during cleanup error=Cache update failed
2025-10-14 02:55:52.569 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:55:52.574 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:55:52.575 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 200 | Failed to get REST handler for exchange exchange=kraken error=Handler creation failed
2025-10-14 02:55:52.577 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:55:52.578 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 02:55:52.579 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 364 | Error collecting batch for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 02:55:52.579 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 235 | Historical collection failed for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 02:55:52.581 | WARNING  | fullon_ohlcv_service.ohlcv.historic_collector | 68 | Historical collection already running
2025-10-14 02:55:52.592 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 169 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 02:55:52.592 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:55:52.593 | WARNING  | fullon_ohlcv_service.daemon | 75 | No symbols found in database - nothing to collect
2025-10-14 02:55:52.593 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:55:52.593 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:55:52.601 | WARNING  | fullon_ohlcv_service.ohlcv.historic_collector | 436 | Skipping candle with None values raw_candle=[1640995260000, None, 51500, 49500, 51000, 150]
2025-10-14 02:55:52.612 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 72 | Starting historical OHLCV collection
2025-10-14 02:55:52.613 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 114 | Historical collection completed total_symbols=0 total_candles=0
2025-10-14 02:55:52.617 | WARNING  | fullon_ohlcv_service.ohlcv.live_collector | 42 | Live collection already running
2025-10-14 02:55:52.622 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 74 | Stopping live OHLCV collection
2025-10-14 02:55:52.622 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 72 | Starting historical OHLCV collection
2025-10-14 02:55:52.623 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=binance symbol_count=1
2025-10-14 02:55:52.623 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 199 | Failed to get REST handler for exchange exchange=binance error=object MagicMock can't be used in 'await' expression
2025-10-14 02:55:52.624 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 114 | Historical collection completed total_symbols=0 total_candles=0
2025-10-14 02:55:52.630 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:55:52.630 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 132 | Exchange supports native OHLCV - proceeding with subscription exchange=binance symbol_count=1
2025-10-14 02:55:52.631 | INFO     | fullon_cache.event_loop | 134 | Event loop configured: uvloop
2025-10-14 02:55:52.631 | INFO     | fullon_cache.connection | 121 | uvloop configured for optimal Redis performance
2025-10-14 02:55:52.632 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 86 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 02:55:52.644 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:55:52.643 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 166 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 02:55:52.646 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 183 | Finished subscribing to OHLCV exchange=binance symbol_count=1
2025-10-14 02:55:52.677 | ERROR    | fullon_ohlcv_service.ohlcv.live_collector | 238 | Error processing OHLCV exchange=binance symbol=BTC/USDT error=not enough values to unpack (expected 6, got 1)
2025-10-14 02:55:52.709 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:55:52.709 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 291 | Symbol already collecting symbol_key=binance:BTC/USDT
2025-10-14 02:55:52.710 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 02:55:52.710 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:55:52.711 | ERROR    | fullon_ohlcv_service.daemon | 119 | Daemon error error=OHLCV collection failed
2025-10-14 02:55:52.711 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:55:52.712 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:55:52.712 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:55:52.713 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:55:52.727 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=ETH/USDT
2025-10-14 02:55:52.728 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 353 | Added symbol to collector symbol=ETH/USDT exchange=binance
2025-10-14 02:55:52.737 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 356 | Creating new handler exchange=binance symbol=BTC/USDT
2025-10-14 02:55:52.742 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=1 total_symbols=1
2025-10-14 02:55:52.752 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=BTC/USDT
2025-10-14 02:55:52.754 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 353 | Added symbol to collector symbol=BTC/USDT exchange=binance
2025-10-14 02:55:52.760 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=BTC/USDT
2025-10-14 02:55:52.761 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 317 | Exchange needs trades for OHLCV, skipping exchange=binance symbol=BTC/USDT
2025-10-14 02:55:52.764 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.768 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.772 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.783 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.790 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.796 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.802 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.803 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.804 | INFO     | fullon_ohlcv_service.trade.batcher | 105 | Batch processing started
2025-10-14 02:55:52.808 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.810 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.811 | INFO     | fullon_ohlcv_service.trade.batcher | 87 | Symbol unregistered from batch processing exchange=kraken symbol=ETH/USD remaining_symbols=2
2025-10-14 02:55:52.816 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.817 | INFO     | fullon_ohlcv_service.trade.batcher | 105 | Batch processing started
2025-10-14 02:55:52.815 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.820 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='130533232236528'>
2025-10-14 02:55:52.822 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='130533232237200'>
2025-10-14 02:55:52.821 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:55:52.824 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:55:52.824 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='130533232236528'>
2025-10-14 02:55:52.825 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 122 | Exchange requires trade collection instead of OHLCV - skipping OHLCV subscription exchange=binance symbol_count=1
2025-10-14 02:55:52.824 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='130533232237200'>
2025-10-14 02:55:52.825 | INFO     | fullon_ohlcv_service.trade.batcher | 257 | Batch cycle completed - no trades to process total_symbols=2 duration_seconds=0.01
2025-10-14 02:55:52.835 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:55:52.835 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 122 | Exchange requires trade collection instead of OHLCV - skipping OHLCV subscription exchange=binance symbol_count=1
2025-10-14 02:55:52.844 | WARNING  | fullon_ohlcv_service.trade.historic_collector | 69 | Historical collection already running
2025-10-14 02:55:52.849 | INFO     | fullon_ohlcv_service.trade.historic_collector | 169 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 02:55:52.855 | INFO     | fullon_ohlcv_service.trade.historic_collector | 73 | Starting historical trade collection
2025-10-14 02:55:52.855 | INFO     | fullon_ohlcv_service.trade.historic_collector | 115 | Historical collection completed total_symbols=0 total_trades=0
2025-10-14 02:55:52.859 | INFO     | fullon_ohlcv_service.trade.historic_collector | 73 | Starting historical trade collection
2025-10-14 02:55:52.861 | WARNING  | fullon_ohlcv_service.trade.historic_collector | 92 | No admin exchange found for collection exchange=binance
2025-10-14 02:55:52.862 | INFO     | fullon_ohlcv_service.trade.historic_collector | 115 | Historical collection completed total_symbols=0 total_trades=0
2025-10-14 02:55:52.866 | INFO     | fullon_ohlcv_service.daemon | 171 | Starting two-phase collection for single symbol symbol=BTC/USDC exchange=kraken
2025-10-14 02:55:52.869 | WARNING  | fullon_ohlcv_service.trade.live_collector | 43 | Live collection already running
2025-10-14 02:55:52.867 | INFO     | fullon_ohlcv_service.daemon | 180 | Phase 1: Starting historic collection
2025-10-14 02:55:52.868 | INFO     | fullon_ohlcv_service.daemon | 188 | Phase 1: Historic collection completed
2025-10-14 02:55:52.868 | INFO     | fullon_ohlcv_service.daemon | 197 | Phase 2: Starting live streaming
2025-10-14 02:55:52.869 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDC
2025-10-14 02:55:52.872 | INFO     | fullon_ohlcv_service.trade.live_collector | 75 | Stopping live trade collection
2025-10-14 02:55:52.879 | INFO     | fullon_ohlcv_service.trade.live_collector | 94 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 02:55:52.878 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:55:52.879 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 02:55:52.881 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 02:55:52.890 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:55:52.891 | WARNING  | fullon_ohlcv_service.trade.live_collector | 166 | Failed to subscribe to trades exchange=binance symbol=BTC/USDT error=Subscription failed
2025-10-14 02:55:52.892 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 02:55:52.893 | WARNING  | fullon_ohlcv_service.trade.live_collector | 192 | Trade object missing symbol attribute exchange=binance trade_obj=<Mock id='135809880502160'>
2025-10-14 02:55:52.900 | ERROR    | fullon_ohlcv_service.trade.live_collector | 225 | Error processing trade exchange=binance error=Cache error
2025-10-14 02:55:52.910 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:55:52.921 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:55:52.931 | ERROR    | fullon_exchange.queue.exchange_queue | 730 | Failed to create/connect WebSocket handler for binance: Credentials not found for ex_id <Mock name='mock.ex_id' id='130533232893232'>
2025-10-14 02:55:52.931 | ERROR    | fullon_ohlcv_service.trade.live_collector | 180 | Error starting WebSocket for exchange exchange=binance error=Failed to create WebSocket handler: Credentials not found for ex_id <Mock name='mock.ex_id' id='130533232893232'>
2025-10-14 02:55:52.975 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:55:52.983 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 02:55:52.984 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol kraken:BTC/USDC'
2025-10-14 02:55:53.009 | ERROR    | fullon_ohlcv.repositories.ohlcv.base_repository | 426 | Failed to create hypertable for kraken.btc_usdc_trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedFunctionError'>: function create_hypertable(regclass, unknown, if_not_exists => boolean) does not exist
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[SQL: 
                    SELECT create_hypertable(
                        'kraken.btc_usdc_trades'::regclass,
                        'timestamp',
                        if_not_exists => TRUE
                    )
                ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:55:53.013 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 40 | Failed to initialize symbol kraken:BTC/USDC
2025-10-14 02:55:53.013 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 95 | Failed to initialize symbol kraken:BTC/USDC
2025-10-14 02:55:53.014 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 0/1 successful
2025-10-14 02:55:53.014 | WARNING  | fullon_ohlcv_service.daemon | 145 | Symbol initialization failed - continuing anyway symbol=BTC/USDC exchange=kraken
2025-10-14 02:55:53.015 | ERROR    | fullon_ohlcv_service.daemon | 207 | Daemon in inconsistent state - cannot proceed
2025-10-14 02:55:53.050 | INFO     | fullon_ohlcv_service.daemon | 171 | Starting two-phase collection for single symbol symbol=BTC/USDT exchange=binance
2025-10-14 02:55:53.051 | INFO     | fullon_ohlcv_service.daemon | 180 | Phase 1: Starting historic collection
2025-10-14 02:55:53.052 | INFO     | fullon_ohlcv_service.daemon | 188 | Phase 1: Historic collection completed
2025-10-14 02:55:53.052 | INFO     | fullon_ohlcv_service.daemon | 197 | Phase 2: Starting live streaming
2025-10-14 02:55:53.053 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:55:53.160 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 02:55:53.160 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:55:53.723 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:55:53.732 | ERROR    | fullon_exchange.queue.exchange_queue | 730 | Failed to create/connect WebSocket handler for binance: Credentials not found for ex_id <Mock name='mock.ex_id' id='135809879973168'>
2025-10-14 02:55:53.732 | ERROR    | fullon_ohlcv_service.trade.live_collector | 180 | Error starting WebSocket for exchange exchange=binance error=Failed to create WebSocket handler: Credentials not found for ex_id <Mock name='mock.ex_id' id='135809879973168'>
2025-10-14 02:57:05.981 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:57:07.049 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:57:07.174 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:57:07.185 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:57:07.295 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:57:07.743 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 02:57:07.883 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 02:57:07.883 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 02:57:07.951 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 02:57:08.143 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 02:57:08.145 | INFO     | fullon_ohlcv_service.utils.add_symbols | 37 | Successfully initialized symbol binance:BTC/USDT
2025-10-14 02:57:08.147 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 02:57:08.148 | INFO     | fullon_ohlcv_service.utils.add_symbols | 131 | Found 2 symbols for exchange binance
2025-10-14 02:57:08.149 | INFO     | fullon_ohlcv_service.utils.add_symbols | 143 | Exchange binance initialization: 1/2 successful
2025-10-14 02:57:08.154 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 02:57:08.155 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 44 | Error initializing symbol binance:BTC/USDT: Init failed
2025-10-14 02:57:08.158 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 02:57:08.158 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 147 | Error initializing symbols for exchange binance: Database error
2025-10-14 02:57:08.165 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 02:57:08.165 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 44 | Error initializing symbol binance:BTC/USDT: Repository creation failed
2025-10-14 02:57:08.175 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:57:08.176 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 2 symbols to initialize
2025-10-14 02:57:08.176 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 2/2 successful
2025-10-14 02:57:08.183 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:57:08.185 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 02:57:08.185 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/1 successful
2025-10-14 02:57:08.192 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:57:08.193 | WARNING  | fullon_ohlcv_service.utils.add_symbols | 72 | No symbols found
2025-10-14 02:57:08.199 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:57:08.200 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 2 symbols to initialize
2025-10-14 02:57:08.201 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 95 | Failed to initialize symbol <MagicMock name='mock.exchange_name' id='137977730585600'>:ETH/USDT
2025-10-14 02:57:08.201 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/2 successful
2025-10-14 02:57:08.201 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:57:08.202 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=2
2025-10-14 02:57:08.203 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:57:08.203 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 02:57:08.204 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 02:57:08.204 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:57:08.204 | INFO     | fullon_ohlcv_service.trade.live_collector | 75 | Stopping live trade collection
2025-10-14 02:57:08.205 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.205 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:57:08.208 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:57:08.209 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 102 | Error during bulk symbol initialization: Database connection failed
2025-10-14 02:57:08.214 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:57:08.215 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 02:57:08.215 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/1 successful
2025-10-14 02:57:08.223 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 02:57:08.224 | INFO     | fullon_ohlcv_service.utils.add_symbols | 131 | Found 2 symbols for exchange binance
2025-10-14 02:57:08.225 | INFO     | fullon_ohlcv_service.utils.add_symbols | 143 | Exchange binance initialization: 2/2 successful
2025-10-14 02:57:08.233 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 02:57:08.234 | WARNING  | fullon_ohlcv_service.utils.add_symbols | 128 | No symbols found for exchange binance
2025-10-14 02:57:08.307 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:57:08.309 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 02:57:08.311 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:57:08.312 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 02:57:08.312 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 02:57:08.313 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:57:08.314 | WARNING  | fullon_ohlcv_service.daemon | 230 | Error stopping collector during cleanup error=object MagicMock can't be used in 'await' expression
2025-10-14 02:57:08.315 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:57:08.358 | INFO     | fullon_ohlcv_service.daemon | 155 | Symbol already collecting symbol=BTC/USDT
2025-10-14 02:57:08.366 | INFO     | fullon_ohlcv_service.daemon | 159 | Symbol already collecting symbol=BTC/USDT
2025-10-14 02:57:08.376 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 02:57:08.376 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:57:08.384 | WARNING  | fullon_ohlcv_service.daemon | 145 | Symbol initialization failed - continuing anyway symbol=BTC/USDT exchange=binance
2025-10-14 02:57:08.385 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 02:57:08.385 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:57:08.398 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 02:57:08.399 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:57:08.414 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=2 total_symbols=4
2025-10-14 02:57:08.426 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:57:08.428 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 02:57:08.428 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 02:57:08.429 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:57:08.432 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 02:57:08.433 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 02:57:08.435 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:57:08.436 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:57:08.447 | WARNING  | fullon_ohlcv_service.config.database_config | 60 | Category exchange not found for cat_ex_id 1
2025-10-14 02:57:08.448 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 02:57:08.460 | WARNING  | fullon_ohlcv_service.config.database_config | 60 | Category exchange not found for cat_ex_id 1
2025-10-14 02:57:08.460 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 02:57:08.486 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-13 02:00:00.000000', 50000.0, 50210.37, 49825.23, 50116.13, 704.958), ('2025-10-13 03:00:00.000000', 50116.13, 50608.72, 50106.09, 50527.05, 1522.5521), ('2025-10-13 04:00:00.000000', 50527.05, 50836.09, 50051.18, 50173.61, 1513.2193), ('2025-10-13 05:00:00.000000', 50173.61, 50272.8, 49881.93, 49903.94, 1463.835), ('2025-10-13 06:00:00.000000', 49903.94, 50107.17, 49474.98, 49962.73, 661.681), ('2025-10-13 07:00:00.000000', 49962.73, 50331.18, 49498.42, 50194.56, 914.9479), ('2025-10-13 08:00:00.000000', 50194.56, 50464.61, 49912.44, 50198.47, 1079.2163), ('2025-10-13 09:00:00.000000', 50198.47, 50381.33, 49708.23, 49975.68, 1231.012), ('2025-10-13 10:00:00.000000', 49975.68, 50141.21, 49684.0, 49784.48, 1196.3616), ('2025-10-13 11:00:00.000000', 49784.48, 50245.69, 49581.45, 50071.05, 1259.3956), ('2025-10-13 12:00:00.000000', 50071.05, 50441.28, 49741.65, 50363.49, 635.8866), ('2025-10-13 13:00:00.000000', 50363.49, 50730.74, 50278.05, 50347.28, 758.415), ('2025-10-13 14:00:00.000000', 50347.28, 50501.45, 50173.42, 50500.88, 874.0499), ('2025-10-13 15:00:00.000000', 50500.88, 50665.52, 50202.32, 50252.91, 1081.9685), ('2025-10-13 16:00:00.000000', 50252.91, 50694.79, 49782.19, 50028.38, 905.1076), ('2025-10-13 17:00:00.000000', 50028.38, 50336.5, 49737.24, 50321.81, 1470.4187), ('2025-10-13 18:00:00.000000', 50321.81, 50349.26, 50114.51, 50182.36, 1208.0418), ('2025-10-13 19:00:00.000000', 50182.36, 50389.96, 50158.12, 50194.55, 660.0795), ('2025-10-13 20:00:00.000000', 50194.55, 50399.05, 49929.74, 50230.9, 954.2479), ('2025-10-13 21:00:00.000000', 50230.9, 50342.91, 50222.72, 50282.32, 531.0738), ('2025-10-13 22:00:00.000000', 50282.32, 50610.72, 50240.76, 50463.28, 984.6757), ('2025-10-13 23:00:00.000000', 50463.28, 50509.05, 50404.86, 50482.66, 1143.0514), ('2025-10-14 00:00:00.000000', 50482.66, 50708.39, 50356.07, 50623.66, 1384.2546), ('2025-10-14 01:00:00.000000', 50623.66, 50636.6, 50461.38, 50621.28, 1029.4516)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:57:08.507 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:57:00.000000', 41043.64, 41970.88934137255, 40550.52097753378, 41860.736466867245, 337.1563)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:57:08.516 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 01:57:08.436542', 45000.0, 1.7618652864996864, 'sell', 'market'), ('2025-10-14 01:57:12.064005', 45040.85515022638, 1.162585924058251, 'buy', 'market'), ('2025-10-14 01:57:28.235030', 45076.94832751233, 0.7102109918727273, 'sell', 'limit'), ('2025-10-14 01:57:24.850391', 45134.957003777425, 1.0997784757986817, 'sell', 'market'), ('2025-10-14 01:57:33.212890', 45190.19793954028, 0.4120065939974293, 'sell', 'market'), ('2025-10-14 01:57:30.901997', 45186.233202606454, 1.157332225752873, 'sell', 'market'), ('2025-10-14 01:58:00.061346', 45191.60961004846, 1.9599825526447263, 'buy', 'market'), ('2025-10-14 01:58:10.562683', 45189.57455164428, 0.40244570949679564, 'buy', 'limit'), ('2025-10-14 01:58:14.965166', 45195.33099785465, 0.23233745984017362, 'sell', 'limit'), ('2025-10-14 01:58:20.809439', 45166.447612493124, 0.15105124397603836, 'sell', 'market'), ('2025-10-14 01:57:40.547642', 45221.09422078448, 1.2681518421621671, 'buy', 'market'), ('2025-10-14 01:57:21.364644', 45170.337251689314, 0.32183745064297403, 'buy', 'market'), ('2025-10-14 01:57:28.911830', 45132.58816089384, 0.1943582564935811, 'buy', 'limit'), ('2025-10-14 01:59:00.588387', 45091.188086442184, 0.24474053733656537, 'buy', 'limit'), ('2025-10-14 01:58:25.996500', 45063.285506803375, 1.7000638625975695, 'buy', 'market'), ('2025-10-14 01:58:54.359102', 45076.641831369554, 0.3038069857565631, 'buy', 'market'), ('2025-10-14 01:57:53.405070', 45057.287303886675, 0.23981092573757584, 'buy', 'market'), ('2025-10-14 01:57:33.385606', 45101.63542621277, 0.9998285799799309, 'buy', 'market'), ('2025-10-14 01:57:40.044344', 45064.21709182177, 1.1356819089922252, 'buy', 'market'), ('2025-10-14 01:59:12.979357', 45072.272466637885, 0.7917598940306944, 'buy', 'market'), ('2025-10-14 01:57:33.066062', 45057.45554889464, 1.9533366130877512, 'sell', 'market'), ('2025-10-14 01:59:03.380651', 45010.4801328992, 1.6451464101293491, 'sell', 'market'), ('2025-10-14 01:58:28.359462', 45036.430972610295, 1.7058325833264647, 'buy', 'limit'), ('2025-10-14 01:59:39.187880', 45082.77135506453, 1.9929191585736405, 'sell', 'market'), ('2025-10-14 01:58:53.194766', 45097.662556336836, 0.8409843917071921, 'buy', 'market'), ('2025-10-14 01:59:56.014967', 45028.14697954166, 1.1758921836369625, 'buy', 'market'), ('2025-10-14 02:00:25.401908', 44987.62346084608, 0.3099958130125984, 'sell', 'market'), ('2025-10-14 01:58:09.179819', 44942.09856698988, 1.243691430379468, 'sell', 'limit'), ('2025-10-14 01:59:25.313310', 44925.42009793331, 1.6711102235334414, 'buy', 'market'), ('2025-10-14 02:00:12.792529', 45023.71673570442, 1.9586150362785597, 'buy', 'market'), ('2025-10-14 02:01:06.545912', 45052.30521628134, 0.9167133448909288, 'buy', 'market'), ('2025-10-14 02:02:12.837880', 44966.17424754956, 1.5156894039589137, 'sell', 'market'), ('2025-10-14 01:59:18.289790', 44974.090278167685, 0.5283802344272873, 'sell', 'limit'), ('2025-10-14 01:59:56.991995', 44989.46560931414, 1.1502709960066406, 'buy', 'market'), ('2025-10-14 02:02:10.107866', 44983.71324247431, 0.1342217812857352, 'sell', 'market'), ('2025-10-14 01:57:43.516692', 44932.993912418504, 1.5466709907162115, 'sell', 'market'), ('2025-10-14 02:01:21.462146', 45041.53156675708, 1.759676142648647, 'buy', 'market'), ('2025-10-14 01:59:16.273947', 44996.59080035282, 1.8101638420855917, 'buy', 'market'), ('2025-10-14 01:57:21.445082', 45044.59088142087, 0.377921148226118, 'buy', 'market'), ('2025-10-14 01:59:48.619058', 45048.59742792854, 1.2861568658481708, 'buy', 'limit'), ('2025-10-14 01:59:38.911782', 45035.41993049415, 1.703893353926099, 'sell', 'market'), ('2025-10-14 01:57:56.333808', 45010.731742544514, 0.23237824103542917, 'sell', 'limit'), ('2025-10-14 02:01:50.663144', 45064.91956691236, 0.4205351814625435, 'buy', 'market'), ('2025-10-14 01:58:13.881252', 45046.86174969183, 0.5652610443685802, 'buy', 'limit'), ('2025-10-14 02:02:50.685570', 45067.48062060948, 0.6870169618417719, 'buy', 'market'), ('2025-10-14 02:01:16.374797', 45082.33981773466, 0.9939386318266693, 'buy', 'market'), ('2025-10-14 01:57:42.095570', 45055.73846040357, 1.0329233534884057, 'buy', 'market'), ('2025-10-14 02:04:53.500837', 45075.21351260258, 0.2566065867004289, 'buy', 'market'), ('2025-10-14 02:02:29.883134', 44972.482371520986, 0.9304910224266723, 'sell', 'market'), ('2025-10-14 02:00:20.442160', 44909.85828728115, 1.0057729514845473, 'sell', 'market'), ('2025-10-14 01:58:50.394742', 44928.52132344719, 0.5057610978626389, 'buy', 'market'), ('2025-10-14 01:57:45.704792', 44952.32632239481, 1.2281202114250267, 'buy', 'limit'), ('2025-10-14 02:03:06.874518', 44957.721231501455, 1.7303429286324656, 'buy', 'market'), ('2025-10-14 01:58:50.693894', 44943.26357847483, 0.8679343590583048, 'sell', 'market'), ('2025-10-14 01:59:02.658206', 45016.73179258035, 1.062909026815374, 'buy', 'market'), ('2025-10-14 02:03:44.097577', 44994.38322283444, 0.7692458187992604, 'sell', 'market'), ('2025-10-14 02:03:10.441094', 45005.393369606856, 0.6049481455468244, 'buy', 'market'), ('2025-10-14 02:03:08.946380', 44992.61532517553, 1.8365334851493247, 'sell', 'market'), ('2025-10-14 02:04:41.838550', 44974.33075558658, 1.9444009334636554, 'sell', 'market'), ('2025-10-14 02:02:56.549168', 45053.74404937697, 1.2195271818423552, 'buy', 'market'), ('2025-10-14 02:04:41.369282', 45057.44147634481, 1.1912899338913028, 'buy', 'limit'), ('2025-10-14 02:00:26.139860', 45007.53973662337, 0.48002645862477616, 'sell', 'market'), ('2025-10-14 02:02:48.244778', 45058.017184027856, 0.5362447846944813, 'buy', 'market'), ('2025-10-14 02:05:32.292902', 45052.38354392235, 1.2436106787426495, 'sell', 'market'), ('2025-10-14 02:06:22.845310', 45030.91980832999, 1.0834777996502247, 'sell', 'limit'), ('2025-10-14 02:00:59.852727', 45014.97574274093, 1.7432603036291847, 'sell', 'market'), ('2025-10-14 02:04:57.329384', 45065.131557192275, 1.8175380998192647, 'sell', 'market'), ('2025-10-14 02:02:49.711762', 45117.23489483562, 1.0510563309284564, 'buy', 'market'), ('2025-10-14 02:08:04.446822', 45051.726339724984, 0.8646628328137831, 'sell', 'limit'), ('2025-10-14 02:04:23.609951', 45071.573211371186, 0.7341821769063988, 'buy', 'market'), ('2025-10-14 02:00:51.646102', 45089.37750431869, 1.5619764083031136, 'buy', 'limit'), ('2025-10-14 01:58:12.562038', 45043.4037657818, 1.6592959235028264, 'sell', 'market'), ('2025-10-14 02:05:57.265598', 45035.185055575064, 1.7769255943367053, 'sell', 'market'), ('2025-10-14 02:05:42.190905', 45066.094361900425, 1.5042231239516135, 'sell', 'market'), ('2025-10-14 02:01:30.656726', 45064.636112715176, 0.8818992338604279, 'buy', 'limit'), ('2025-10-14 02:02:28.841192', 45047.64978504503, 0.6237669718400517, 'sell', 'market'), ('2025-10-14 02:08:10.452478', 45012.87133183038, 0.357928224406813, 'sell', 'market'), ('2025-10-14 01:57:39.145990', 45002.00769396212, 0.14288726430947493, 'sell', 'market'), ('2025-10-14 02:07:29.645390', 45099.39737902974, 1.2007330607856765, 'buy', 'market'), ('2025-10-14 02:00:01.192952', 45120.10212028836, 0.3591854357291976, 'buy', 'limit'), ('2025-10-14 02:05:58.092302', 45174.33088798551, 1.0529085921661532, 'buy', 'limit'), ('2025-10-14 01:57:38.789834', 45197.36132873861, 1.003084730904219, 'buy', 'market'), ('2025-10-14 02:04:04.681826', 45220.55359209968, 1.5469150510183918, 'buy', 'market'), ('2025-10-14 01:57:27.000156', 45133.532717296184, 1.0894585987920478, 'sell', 'market'), ('2025-10-14 02:08:43.532426', 45122.6301527775, 1.110158305330413, 'buy', 'market'), ('2025-10-14 02:02:56.867607', 45254.1207635032, 1.0579471838612242, 'buy', 'market'), ('2025-10-14 02:10:04.190684', 45225.048003204516, 1.0644367098956622, 'buy', 'market'), ('2025-10-14 01:59:35.560763', 45305.840535559415, 0.057632280695518644, 'buy', 'market'), ('2025-10-14 02:08:54.764230', 45251.89199484749, 1.9620579577509514, 'sell', 'market'), ('2025-10-14 02:10:49.178611', 45261.25939677394, 1.3302731722632501, 'sell', 'market'), ('2025-10-14 02:11:32.399642', 45298.65748411803, 0.37340737313610933, 'sell', 'market'), ('2025-10-14 01:59:50.513730', 45232.02638303935, 1.5453847975527055, 'buy', 'market'), ('2025-10-14 02:06:46.945790', 45315.896332039614, 1.3803769119913905, 'buy', 'limit'), ('2025-10-14 02:01:10.375391', 45291.412040767485, 0.7920089125387975, 'sell', 'market'), ('2025-10-14 02:05:52.802194', 45303.49701325556, 0.5950838368093657, 'buy', 'market'), ('2025-10-14 02:01:08.461547', 45370.27703041307, 1.993933030443785, 'buy', 'market'), ('2025-10-14 02:04:28.169150', 45439.08833348976, 0.30188649849765437, 'buy', 'market'), ('2025-10-14 02:09:54.536334', 45390.537670005695, 1.4567464043452862, 'sell', 'market'), ('2025-10-14 02:08:48.414870', 45393.744481018635, 0.9102551316042221, 'buy', 'market'), ('2025-10-14 02:09:15.906956', 45374.78241889038, 1.2714306252985965, 'sell', 'limit')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:57:08.536 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 02:57:08.520521', 42516.77, 6.52346381, 'sell', 'market')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:57:08.556 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:57:00.000000', 44890.25, 45564.0297439526, 44370.680819579386, 45319.64685944276, 6334.0499)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:57:08.563 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:57:00.000000', 36306.46, 36498.99698069331, 35695.1563963632, 36230.14049927625, 3617.4874)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:57:08.564 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:57:00.000000', 33531.65, 34146.58255495944, 32750.68322504923, 32832.4086894831, 9821.2493)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:57:08.571 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-13 16:00:00.000000', 34926.12, 35267.11636270012, 34472.74082434227, 35113.153319870326, 1016.7191), ('2025-10-13 17:00:00.000000', 42202.87, 42799.64004508338, 41850.47202499685, 42653.09737878788, 8608.1605), ('2025-10-13 18:00:00.000000', 33966.18, 34381.81515362301, 33810.398851057595, 34232.74551031773, 9929.6482), ('2025-10-13 19:00:00.000000', 30602.85, 31457.447930009283, 29688.27308323346, 30405.401283311996, 8405.3892), ('2025-10-13 20:00:00.000000', 33639.27, 34363.392809994024, 32812.738918859475, 33345.044336813946, 6589.3217), ('2025-10-13 21:00:00.000000', 46782.0, 47006.029703011576, 46001.428577677485, 46402.46225587768, 5972.8377), ('2025-10-13 22:00:00.000000', 49187.45, 50024.94159281087, 48941.597061109656, 49793.54902630248, 8038.8541), ('2025-10-13 23:00:00.000000', 35634.53, 35810.897333135516, 35091.667514225686, 35185.026313643786, 491.4937), ('2025-10-14 00:00:00.000000', 40126.19, 41107.036464081735, 40014.94722612774, 40893.7143716489, 9590.1674), ('2025-10-14 01:00:00.000000', 37969.37, 38511.12156607127, 37139.42951217669, 37218.03557889931, 5114.0271)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:57:08.565 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:57:08.571 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 02:57:08.572 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:57:08.573 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 02:57:08.574 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 02:57:08.574 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:57:08.575 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:57:08.608 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 02:56:48.582709', 34408.68, 2.05281688, 'sell', 'market'), ('2025-10-14 02:56:49.582709', 41333.24, 7.95119648, 'buy', 'limit'), ('2025-10-14 02:56:50.582709', 31579.87, 0.31794647, 'buy', 'limit'), ('2025-10-14 02:56:51.582709', 45581.08, 8.56493791, 'sell', 'limit'), ('2025-10-14 02:56:52.582709', 35930.09, 3.16228763, 'buy', 'market'), ('2025-10-14 02:56:53.582709', 36283.45, 1.72271327, 'sell', 'market'), ('2025-10-14 02:56:54.582709', 47304.59, 6.62597828, 'sell', 'limit'), ('2025-10-14 02:56:55.582709', 33343.63, 6.84100779, 'buy', 'limit'), ('2025-10-14 02:56:56.582709', 30868.54, 8.18590274, 'buy', 'limit'), ('2025-10-14 02:56:57.582709', 38703.22, 5.60387641, 'buy', 'limit'), ('2025-10-14 02:56:58.582709', 48658.84, 3.99541869, 'buy', 'market'), ('2025-10-14 02:56:59.582709', 46143.78, 2.139368, 'sell', 'limit'), ('2025-10-14 02:57:00.582709', 47918.88, 7.59541789, 'sell', 'limit'), ('2025-10-14 02:57:01.582709', 37511.52, 8.16801545, 'buy', 'limit'), ('2025-10-14 02:57:02.582709', 40147.82, 0.51880582, 'buy', 'market'), ('2025-10-14 02:57:03.582709', 36589.66, 1.60625452, 'sell', 'market'), ('2025-10-14 02:57:04.582709', 45785.2, 8.52223073, 'buy', 'market'), ('2025-10-14 02:57:05.582709', 39551.33, 4.16645003, 'buy', 'market'), ('2025-10-14 02:57:06.582709', 40709.79, 9.89562571, 'buy', 'limit'), ('2025-10-14 02:57:07.582709', 41197.29, 7.30565697, 'buy', 'market')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:57:08.631 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 02:57:00.000000', 38418.36, 38972.019431901324, 37855.15830431273, 37950.359656624256, 2374.9132)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:57:08.648 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:57:08.649 | INFO     | fullon_ohlcv_service.trade.historic_collector | 215 | Exchange has native OHLCV support - skipping trade collection exchange=kraken symbol_count=1
2025-10-14 02:57:08.651 | WARNING  | fullon_ohlcv_service.ohlcv.historic_collector | 68 | Historical collection already running
2025-10-14 02:57:08.664 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 169 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 02:57:08.669 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:57:08.670 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:57:08.671 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 02:57:08.680 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:57:08.683 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:57:08.688 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 72 | Starting historical OHLCV collection
2025-10-14 02:57:08.688 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 114 | Historical collection completed total_symbols=0 total_candles=0
2025-10-14 02:57:08.692 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:57:08.693 | WARNING  | fullon_ohlcv_service.daemon | 230 | Error stopping collector during cleanup error=Stop failed
2025-10-14 02:57:08.694 | WARNING  | fullon_ohlcv_service.daemon | 242 | Failed to update ProcessCache during cleanup error=Cache update failed
2025-10-14 02:57:08.694 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:57:08.699 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:57:08.700 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:57:08.701 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 02:57:08.696 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 72 | Starting historical OHLCV collection
2025-10-14 02:57:08.697 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=binance symbol_count=1
2025-10-14 02:57:08.698 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 199 | Failed to get REST handler for exchange exchange=binance error=object MagicMock can't be used in 'await' expression
2025-10-14 02:57:08.698 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 114 | Historical collection completed total_symbols=0 total_candles=0
2025-10-14 02:57:08.724 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:57:08.725 | WARNING  | fullon_ohlcv_service.daemon | 75 | No symbols found in database - nothing to collect
2025-10-14 02:57:08.726 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:57:08.726 | WARNING  | fullon_ohlcv_service.ohlcv.historic_collector | 436 | Skipping candle with None values raw_candle=[1640995260000, None, 51500, 49500, 51000, 150]
2025-10-14 02:57:08.726 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:57:08.728 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:57:08.728 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:57:08.730 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 353 | Error collecting batch for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 02:57:08.730 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 242 | Historical collection failed for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 02:57:08.740 | WARNING  | fullon_ohlcv_service.ohlcv.live_collector | 42 | Live collection already running
2025-10-14 02:57:08.744 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 74 | Stopping live OHLCV collection
2025-10-14 02:57:08.751 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:57:08.751 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:57:08.751 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 132 | Exchange supports native OHLCV - proceeding with subscription exchange=binance symbol_count=1
2025-10-14 02:57:08.752 | INFO     | fullon_cache.event_loop | 134 | Event loop configured: uvloop
2025-10-14 02:57:08.751 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 02:57:08.753 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 241 | Historical collection completed for symbol symbol=kraken:BTC/USD candles_collected=0
2025-10-14 02:57:08.752 | INFO     | fullon_cache.connection | 121 | uvloop configured for optimal Redis performance
2025-10-14 02:57:08.761 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 166 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 02:57:08.761 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 183 | Finished subscribing to OHLCV exchange=binance symbol_count=1
2025-10-14 02:57:08.772 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:57:08.773 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 02:57:08.775 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 241 | Historical collection completed for symbol symbol=kraken:BTC/USD candles_collected=0
2025-10-14 02:57:08.793 | ERROR    | fullon_ohlcv_service.ohlcv.live_collector | 238 | Error processing OHLCV exchange=binance symbol=BTC/USDT error=not enough values to unpack (expected 6, got 1)
2025-10-14 02:57:08.796 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:57:08.797 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 02:57:08.798 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 364 | Error collecting batch for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 02:57:08.799 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 235 | Historical collection failed for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 02:57:08.812 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 86 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 02:57:08.823 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 291 | Symbol already collecting symbol_key=binance:BTC/USDT
2025-10-14 02:57:08.826 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 02:57:08.832 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=ETH/USDT
2025-10-14 02:57:08.834 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 353 | Added symbol to collector symbol=ETH/USDT exchange=binance
2025-10-14 02:57:08.841 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 02:57:08.843 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 02:57:08.843 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 356 | Creating new handler exchange=binance symbol=BTC/USDT
2025-10-14 02:57:08.843 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 02:57:08.844 | ERROR    | fullon_ohlcv_service.daemon | 119 | Daemon error error=OHLCV collection failed
2025-10-14 02:57:08.844 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:57:08.846 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:57:08.847 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 02:57:08.848 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 02:57:08.858 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=BTC/USDT
2025-10-14 02:57:08.859 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 353 | Added symbol to collector symbol=BTC/USDT exchange=binance
2025-10-14 02:57:08.868 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=BTC/USDT
2025-10-14 02:57:08.869 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 317 | Exchange needs trades for OHLCV, skipping exchange=binance symbol=BTC/USDT
2025-10-14 02:57:08.874 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.878 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.882 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.888 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.894 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.908 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.919 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.929 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.930 | INFO     | fullon_ohlcv_service.trade.batcher | 105 | Batch processing started
2025-10-14 02:57:08.939 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.939 | INFO     | fullon_ohlcv_service.trade.batcher | 87 | Symbol unregistered from batch processing exchange=kraken symbol=ETH/USD remaining_symbols=2
2025-10-14 02:57:08.947 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.948 | INFO     | fullon_ohlcv_service.trade.batcher | 105 | Batch processing started
2025-10-14 02:57:08.956 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.962 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.970 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 02:57:08.976 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='138223931241008'>
2025-10-14 02:57:08.977 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='138223931243024'>
2025-10-14 02:57:08.978 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='138223931241008'>
2025-10-14 02:57:08.979 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='138223931243024'>
2025-10-14 02:57:08.979 | INFO     | fullon_ohlcv_service.trade.batcher | 257 | Batch cycle completed - no trades to process total_symbols=2 duration_seconds=0.01
2025-10-14 02:57:09.026 | INFO     | fullon_ohlcv_service.daemon | 171 | Starting two-phase collection for single symbol symbol=BTC/USDC exchange=kraken
2025-10-14 02:57:09.027 | INFO     | fullon_ohlcv_service.daemon | 180 | Phase 1: Starting historic collection
2025-10-14 02:57:09.029 | INFO     | fullon_ohlcv_service.daemon | 188 | Phase 1: Historic collection completed
2025-10-14 02:57:09.029 | INFO     | fullon_ohlcv_service.daemon | 197 | Phase 2: Starting live streaming
2025-10-14 02:57:09.030 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDC
2025-10-14 02:57:09.044 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:57:09.045 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 122 | Exchange requires trade collection instead of OHLCV - skipping OHLCV subscription exchange=binance symbol_count=1
2025-10-14 02:57:09.050 | INFO     | fullon_ohlcv_service.trade.historic_collector | 169 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 02:57:09.054 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:57:09.055 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 122 | Exchange requires trade collection instead of OHLCV - skipping OHLCV subscription exchange=binance symbol_count=1
2025-10-14 02:57:09.062 | WARNING  | fullon_ohlcv_service.trade.historic_collector | 69 | Historical collection already running
2025-10-14 02:57:09.082 | INFO     | fullon_ohlcv_service.trade.historic_collector | 73 | Starting historical trade collection
2025-10-14 02:57:09.083 | INFO     | fullon_ohlcv_service.trade.historic_collector | 115 | Historical collection completed total_symbols=0 total_trades=0
2025-10-14 02:57:09.083 | INFO     | fullon_ohlcv_service.trade.historic_collector | 73 | Starting historical trade collection
2025-10-14 02:57:09.084 | WARNING  | fullon_ohlcv_service.trade.historic_collector | 92 | No admin exchange found for collection exchange=binance
2025-10-14 02:57:09.084 | INFO     | fullon_ohlcv_service.trade.historic_collector | 115 | Historical collection completed total_symbols=0 total_trades=0
2025-10-14 02:57:09.103 | WARNING  | fullon_ohlcv_service.trade.live_collector | 43 | Live collection already running
2025-10-14 02:57:09.103 | INFO     | fullon_ohlcv_service.trade.live_collector | 75 | Stopping live trade collection
2025-10-14 02:57:09.113 | INFO     | fullon_ohlcv_service.trade.live_collector | 94 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 02:57:09.126 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:57:09.127 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 02:57:09.128 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 02:57:09.135 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 02:57:09.135 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 02:57:09.136 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol kraken:BTC/USDC'
2025-10-14 02:57:09.139 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:57:09.140 | WARNING  | fullon_ohlcv_service.trade.live_collector | 166 | Failed to subscribe to trades exchange=binance symbol=BTC/USDT error=Subscription failed
2025-10-14 02:57:09.140 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 02:57:09.151 | WARNING  | fullon_ohlcv_service.trade.live_collector | 192 | Trade object missing symbol attribute exchange=binance trade_obj=<Mock id='134822919913888'>
2025-10-14 02:57:09.160 | ERROR    | fullon_ohlcv_service.trade.live_collector | 225 | Error processing trade exchange=binance error=Cache error
2025-10-14 02:57:09.169 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=1 total_symbols=1
2025-10-14 02:57:09.182 | ERROR    | fullon_ohlcv.repositories.ohlcv.base_repository | 426 | Failed to create hypertable for kraken.btc_usdc_trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedFunctionError'>: function create_hypertable(regclass, unknown, if_not_exists => boolean) does not exist
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[SQL: 
                    SELECT create_hypertable(
                        'kraken.btc_usdc_trades'::regclass,
                        'timestamp',
                        if_not_exists => TRUE
                    )
                ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 02:57:09.185 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 40 | Failed to initialize symbol kraken:BTC/USDC
2025-10-14 02:57:09.185 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:57:09.186 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 95 | Failed to initialize symbol kraken:BTC/USDC
2025-10-14 02:57:09.186 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 0/1 successful
2025-10-14 02:57:09.186 | WARNING  | fullon_ohlcv_service.daemon | 145 | Symbol initialization failed - continuing anyway symbol=BTC/USDC exchange=kraken
2025-10-14 02:57:09.187 | ERROR    | fullon_ohlcv_service.daemon | 207 | Daemon in inconsistent state - cannot proceed
2025-10-14 02:57:09.207 | ERROR    | fullon_exchange.queue.exchange_queue | 730 | Failed to create/connect WebSocket handler for binance: Credentials not found for ex_id <Mock name='mock.ex_id' id='138223930877200'>
2025-10-14 02:57:09.207 | ERROR    | fullon_ohlcv_service.trade.live_collector | 180 | Error starting WebSocket for exchange exchange=binance error=Failed to create WebSocket handler: Credentials not found for ex_id <Mock name='mock.ex_id' id='138223930877200'>
2025-10-14 02:57:09.209 | INFO     | fullon_ohlcv_service.daemon | 171 | Starting two-phase collection for single symbol symbol=BTC/USDT exchange=binance
2025-10-14 02:57:09.210 | INFO     | fullon_ohlcv_service.daemon | 180 | Phase 1: Starting historic collection
2025-10-14 02:57:09.211 | INFO     | fullon_ohlcv_service.daemon | 188 | Phase 1: Historic collection completed
2025-10-14 02:57:09.211 | INFO     | fullon_ohlcv_service.daemon | 197 | Phase 2: Starting live streaming
2025-10-14 02:57:09.212 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:57:09.243 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:57:09.243 | INFO     | fullon_ohlcv_service.trade.historic_collector | 215 | Exchange has native OHLCV support - skipping trade collection exchange=kraken symbol_count=1
2025-10-14 02:57:09.260 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:57:09.261 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:57:09.262 | INFO     | fullon_cache.event_loop | 134 | Event loop configured: uvloop
2025-10-14 02:57:09.262 | INFO     | fullon_cache.connection | 121 | uvloop configured for optimal Redis performance
2025-10-14 02:57:09.274 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 02:57:09.294 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:57:09.294 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 02:57:09.305 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 02:57:09.319 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 02:57:09.320 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 02:57:09.327 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 02:57:09.328 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 200 | Failed to get REST handler for exchange exchange=kraken error=Handler creation failed
2025-10-14 02:57:09.333 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 02:57:09.368 | ERROR    | fullon_exchange.queue.exchange_queue | 730 | Failed to create/connect WebSocket handler for binance: Credentials not found for ex_id <Mock name='mock.ex_id' id='123266221005456'>
2025-10-14 02:57:09.369 | ERROR    | fullon_ohlcv_service.trade.live_collector | 180 | Error starting WebSocket for exchange exchange=binance error=Failed to create WebSocket handler: Credentials not found for ex_id <Mock name='mock.ex_id' id='123266221005456'>
2025-10-14 03:02:39.834 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:02:41.147 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:02:41.173 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:02:41.242 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:02:41.323 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:02:42.015 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 03:02:42.021 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 03:02:42.083 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 03:02:42.103 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 03:02:42.189 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:02:42.188 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:02:42.190 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 03:02:42.192 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 03:02:42.191 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=ETH/USDT success=True
2025-10-14 03:02:42.193 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 03:02:42.203 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:02:42.204 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 03:02:42.206 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:42.207 | INFO     | fullon_ohlcv_service.trade.batcher | 105 | Batch processing started
2025-10-14 03:02:42.210 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 03:02:51.423 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:02:52.650 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:02:52.735 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:02:52.768 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:02:52.791 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:02:53.449 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 03:02:53.549 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 03:02:53.581 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 03:02:53.596 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 03:02:53.844 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 03:02:53.845 | INFO     | fullon_ohlcv_service.utils.add_symbols | 131 | Found 2 symbols for exchange binance
2025-10-14 03:02:53.845 | INFO     | fullon_ohlcv_service.utils.add_symbols | 143 | Exchange binance initialization: 1/2 successful
2025-10-14 03:02:53.850 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 03:02:53.850 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 147 | Error initializing symbols for exchange binance: Database error
2025-10-14 03:02:53.857 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 03:02:53.859 | INFO     | fullon_ohlcv_service.utils.add_symbols | 37 | Successfully initialized symbol binance:BTC/USDT
2025-10-14 03:02:53.871 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 03:02:53.872 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 44 | Error initializing symbol binance:BTC/USDT: Init failed
2025-10-14 03:02:53.877 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 03:02:53.878 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 44 | Error initializing symbol binance:BTC/USDT: Repository creation failed
2025-10-14 03:02:53.889 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:02:53.889 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 2 symbols to initialize
2025-10-14 03:02:53.890 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 2/2 successful
2025-10-14 03:02:53.897 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 03:02:53.898 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=2
2025-10-14 03:02:53.898 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 03:02:53.899 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 03:02:53.899 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 03:02:53.899 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:02:53.900 | INFO     | fullon_ohlcv_service.trade.live_collector | 75 | Stopping live trade collection
2025-10-14 03:02:53.900 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:53.899 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:02:53.900 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 03:02:53.901 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/1 successful
2025-10-14 03:02:53.900 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:02:53.908 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:02:53.908 | WARNING  | fullon_ohlcv_service.utils.add_symbols | 72 | No symbols found
2025-10-14 03:02:53.921 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:02:53.921 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 2 symbols to initialize
2025-10-14 03:02:53.922 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 95 | Failed to initialize symbol <MagicMock name='mock.exchange_name' id='130667541058560'>:ETH/USDT
2025-10-14 03:02:53.923 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/2 successful
2025-10-14 03:02:53.927 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:02:53.927 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 102 | Error during bulk symbol initialization: Database connection failed
2025-10-14 03:02:53.933 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:02:53.933 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 03:02:53.934 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/1 successful
2025-10-14 03:02:53.939 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 03:02:53.940 | INFO     | fullon_ohlcv_service.utils.add_symbols | 131 | Found 2 symbols for exchange binance
2025-10-14 03:02:53.940 | INFO     | fullon_ohlcv_service.utils.add_symbols | 143 | Exchange binance initialization: 2/2 successful
2025-10-14 03:02:53.951 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 03:02:53.952 | WARNING  | fullon_ohlcv_service.utils.add_symbols | 128 | No symbols found for exchange binance
2025-10-14 03:02:54.006 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 03:02:54.007 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 03:02:54.010 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 03:02:54.012 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 03:02:54.012 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 03:02:54.016 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:02:54.018 | WARNING  | fullon_ohlcv_service.daemon | 230 | Error stopping collector during cleanup error=object MagicMock can't be used in 'await' expression
2025-10-14 03:02:54.018 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:02:54.094 | INFO     | fullon_ohlcv_service.daemon | 155 | Symbol already collecting symbol=BTC/USDT
2025-10-14 03:02:54.101 | INFO     | fullon_ohlcv_service.daemon | 159 | Symbol already collecting symbol=BTC/USDT
2025-10-14 03:02:54.115 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 03:02:54.117 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 03:02:54.124 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 03:02:54.128 | WARNING  | fullon_ohlcv_service.daemon | 145 | Symbol initialization failed - continuing anyway symbol=BTC/USDT exchange=binance
2025-10-14 03:02:54.125 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 03:02:54.126 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 03:02:54.128 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 03:02:54.128 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 03:02:54.129 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 03:02:54.129 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:02:54.131 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:02:54.129 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 03:02:54.140 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 03:02:54.142 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 03:02:54.148 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-13 03:00:00.000000', 50000.0, 50442.77, 49664.74, 50197.45, 1430.2464), ('2025-10-13 04:00:00.000000', 50197.45, 50378.99, 49912.45, 50345.04, 1314.961), ('2025-10-13 05:00:00.000000', 50345.04, 50802.17, 50333.89, 50554.88, 1162.1087), ('2025-10-13 06:00:00.000000', 50554.88, 50886.63, 50536.88, 50736.49, 606.4416), ('2025-10-13 07:00:00.000000', 50736.49, 50826.36, 50488.89, 50728.08, 883.6348), ('2025-10-13 08:00:00.000000', 50728.08, 50929.01, 50469.33, 50739.84, 1389.766), ('2025-10-13 09:00:00.000000', 50739.84, 50845.79, 50586.35, 50668.53, 1363.0908), ('2025-10-13 10:00:00.000000', 50668.53, 51140.4, 50629.01, 50706.33, 1236.3646), ('2025-10-13 11:00:00.000000', 50706.33, 50864.03, 50571.07, 50695.38, 547.3325), ('2025-10-13 12:00:00.000000', 50695.38, 51091.08, 50257.31, 50567.97, 1164.2266), ('2025-10-13 13:00:00.000000', 50567.97, 51030.31, 50412.94, 50845.66, 1087.8127), ('2025-10-13 14:00:00.000000', 50845.66, 50883.65, 50422.92, 50567.04, 1282.9096), ('2025-10-13 15:00:00.000000', 50567.04, 50720.95, 50142.68, 50592.87, 565.2958), ('2025-10-13 16:00:00.000000', 50592.87, 50973.85, 50279.7, 50539.5, 860.6069), ('2025-10-13 17:00:00.000000', 50539.5, 50703.29, 50465.5, 50570.66, 508.7678), ('2025-10-13 18:00:00.000000', 50570.66, 50981.38, 50076.83, 50627.31, 558.3621), ('2025-10-13 19:00:00.000000', 50627.31, 51071.84, 50594.81, 50919.05, 1361.5455), ('2025-10-13 20:00:00.000000', 50919.05, 51351.02, 50535.41, 51206.01, 1519.5942), ('2025-10-13 21:00:00.000000', 51206.01, 51520.44, 50717.72, 51417.03, 979.9824), ('2025-10-13 22:00:00.000000', 51417.03, 51458.23, 51347.89, 51404.63, 1121.201), ('2025-10-13 23:00:00.000000', 51404.63, 51434.28, 51303.53, 51361.69, 1200.4748), ('2025-10-14 00:00:00.000000', 51361.69, 51497.18, 51333.25, 51356.94, 732.9581), ('2025-10-14 01:00:00.000000', 51356.94, 51766.68, 51213.56, 51534.66, 752.6955), ('2025-10-14 02:00:00.000000', 51534.66, 52023.49, 51459.14, 52011.64, 1237.3545)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:02:54.159 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=2 total_symbols=4
2025-10-14 03:02:54.159 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 03:02:00.000000', 47695.7, 47922.54504402353, 46902.523081973566, 46914.7695119582, 7965.8421)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:02:54.171 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 03:02:54.174 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 02:02:54.110469', 45000.0, 1.4030524760980752, 'buy', 'market'), ('2025-10-14 02:03:00.634383', 44990.967938416106, 1.8778551101265386, 'buy', 'market'), ('2025-10-14 02:02:57.824821', 44988.62750395015, 1.1809212096191182, 'buy', 'market'), ('2025-10-14 02:03:03.521625', 44989.79445692642, 1.9861308148052366, 'buy', 'market'), ('2025-10-14 02:02:56.367625', 45043.9543588679, 0.37079175972566253, 'sell', 'limit'), ('2025-10-14 02:03:38.322159', 45072.45976999548, 1.3749052734105807, 'buy', 'market'), ('2025-10-14 02:03:48.145209', 45100.19909489984, 1.5508699899485368, 'buy', 'market'), ('2025-10-14 02:03:32.447649', 45065.648401299804, 1.773688283021209, 'buy', 'market'), ('2025-10-14 02:03:53.289301', 45043.15336443468, 1.1533415829327636, 'sell', 'market'), ('2025-10-14 02:03:32.144019', 45104.1322515435, 1.435250836725269, 'buy', 'market'), ('2025-10-14 02:03:25.758869', 45100.76384503116, 0.6520232482098445, 'buy', 'limit'), ('2025-10-14 02:03:14.711742', 45050.9921912443, 1.9427485353825376, 'sell', 'market'), ('2025-10-14 02:03:05.947161', 45192.55992291567, 1.5525801260648258, 'buy', 'market'), ('2025-10-14 02:04:44.406733', 45245.48941525437, 1.9916911837154616, 'sell', 'market'), ('2025-10-14 02:03:01.234327', 45182.752219652655, 1.6345325124697931, 'sell', 'market'), ('2025-10-14 02:05:02.096079', 45176.646640054874, 0.547671329783671, 'buy', 'market'), ('2025-10-14 02:03:51.580405', 45156.37632753203, 1.6661393236754052, 'sell', 'market'), ('2025-10-14 02:04:17.093912', 45167.40582600178, 1.2110019953058675, 'buy', 'market'), ('2025-10-14 02:05:09.382737', 45238.869500013556, 1.9648130148665879, 'buy', 'market'), ('2025-10-14 02:03:30.753812', 45218.668794290694, 1.9243154850319897, 'sell', 'limit'), ('2025-10-14 02:05:40.658589', 45213.37138414747, 1.3518217333864015, 'sell', 'limit'), ('2025-10-14 02:06:12.025074', 45206.7573562438, 1.0905778789602671, 'sell', 'market'), ('2025-10-14 02:03:16.242337', 45258.82505532322, 0.6238108459729851, 'sell', 'market'), ('2025-10-14 02:03:49.114279', 45221.05049440029, 1.6366472576801807, 'sell', 'market'), ('2025-10-14 02:04:10.653045', 45208.0669309984, 0.39501168390877234, 'buy', 'market'), ('2025-10-14 02:05:12.367419', 45222.54162627191, 0.8055823042815794, 'buy', 'market'), ('2025-10-14 02:04:43.741029', 45203.3718083601, 0.15933164298100116, 'sell', 'limit'), ('2025-10-14 02:04:32.557086', 45177.69143533673, 0.4780483383305867, 'sell', 'market'), ('2025-10-14 02:06:51.857713', 45162.26694127502, 0.4076812577114516, 'buy', 'market'), ('2025-10-14 02:05:33.979784', 45173.407611163246, 0.8962783007933026, 'buy', 'market'), ('2025-10-14 02:04:10.942689', 45175.589909757, 0.732373528859989, 'buy', 'market'), ('2025-10-14 02:03:10.660811', 45176.24834559346, 0.7249513899323464, 'buy', 'market'), ('2025-10-14 02:03:55.970981', 45121.98955450289, 1.352605792743307, 'sell', 'market'), ('2025-10-14 02:07:23.297475', 45164.18256314577, 0.9603166502622004, 'buy', 'market'), ('2025-10-14 02:03:12.084705', 45146.07327872616, 0.12423607890590439, 'sell', 'market'), ('2025-10-14 02:06:32.926934', 45112.79421667717, 0.4332039677177362, 'sell', 'market'), ('2025-10-14 02:04:15.422049', 45145.35625788158, 1.3049124458587267, 'buy', 'market'), ('2025-10-14 02:03:15.306178', 45103.32158762872, 1.2099349002788449, 'sell', 'market'), ('2025-10-14 02:03:26.259419', 45078.497784854044, 1.913738019249708, 'buy', 'market'), ('2025-10-14 02:03:46.392114', 45156.20305947246, 1.5174757607497857, 'buy', 'market'), ('2025-10-14 02:06:16.279789', 45236.84678373308, 1.8274165134114075, 'buy', 'market'), ('2025-10-14 02:06:31.165330', 45257.86386823961, 0.5976487491368792, 'buy', 'limit'), ('2025-10-14 02:07:00.342189', 45221.79251356545, 0.49868052000025226, 'sell', 'market'), ('2025-10-14 02:03:08.687727', 45184.24186240352, 0.6182001231292363, 'buy', 'market'), ('2025-10-14 02:06:28.424173', 45172.34546141445, 0.8344202210642059, 'sell', 'limit'), ('2025-10-14 02:06:29.171499', 45175.285717916595, 0.08669790814049387, 'sell', 'market'), ('2025-10-14 02:04:24.423925', 45179.114622747744, 1.207823980759031, 'buy', 'market'), ('2025-10-14 02:08:16.890160', 45240.636907108725, 0.11947095662975843, 'buy', 'market'), ('2025-10-14 02:05:02.122821', 45223.52053591166, 0.02149398975075914, 'buy', 'market'), ('2025-10-14 02:05:17.465163', 45284.49588357889, 0.9392773316321261, 'sell', 'market'), ('2025-10-14 02:04:58.044569', 45225.8610260073, 1.8297601101779208, 'sell', 'market'), ('2025-10-14 02:04:10.148154', 45225.05185972495, 0.6781366826258933, 'sell', 'limit'), ('2025-10-14 02:11:31.096341', 45284.2711551723, 0.8332803841362091, 'buy', 'market'), ('2025-10-14 02:05:20.799735', 45337.59034896908, 1.726056484338851, 'buy', 'limit'), ('2025-10-14 02:08:22.660401', 45367.327850275, 1.091438257926587, 'buy', 'market'), ('2025-10-14 02:03:22.858419', 45450.58315641602, 0.6942878131770595, 'buy', 'market'), ('2025-10-14 02:11:46.701605', 45410.86191731162, 1.9947705115148282, 'buy', 'market'), ('2025-10-14 02:03:46.087002', 45451.264340034315, 0.7323870070295188, 'buy', 'limit'), ('2025-10-14 02:04:11.019281', 45412.096887961, 0.28408881597297175, 'sell', 'limit'), ('2025-10-14 02:05:16.146774', 45372.80502964299, 0.7180520877540111, 'sell', 'market'), ('2025-10-14 02:03:33.060309', 45248.709891113394, 0.39072107127951744, 'sell', 'market'), ('2025-10-14 02:08:17.304146', 45129.89142379342, 0.023139587113467582, 'buy', 'market'), ('2025-10-14 02:03:04.417349', 45147.80614616905, 1.6684453870664555, 'buy', 'market'), ('2025-10-14 02:04:50.803983', 45110.46340756512, 0.8819448266308318, 'sell', 'market'), ('2025-10-14 02:13:27.602437', 45122.958858953425, 0.8129032221936038, 'buy', 'market'), ('2025-10-14 02:10:15.980794', 45136.875689902234, 0.6703234537048793, 'sell', 'limit'), ('2025-10-14 02:04:10.311627', 45085.523471942506, 0.33200009936550506, 'buy', 'market'), ('2025-10-14 02:03:49.308821', 45120.18664367412, 1.0290098300087416, 'buy', 'market'), ('2025-10-14 02:11:17.086477', 45056.249362294926, 0.28479218592218697, 'sell', 'market'), ('2025-10-14 02:03:50.807217', 45086.68737163695, 1.182369182739544, 'sell', 'market'), ('2025-10-14 02:13:41.346009', 45092.24069996792, 0.7052326975663545, 'buy', 'market'), ('2025-10-14 02:14:28.307857', 45156.91726082416, 1.7307268290015114, 'sell', 'market'), ('2025-10-14 02:03:54.893661', 45142.50381277618, 0.4051153836613649, 'sell', 'market'), ('2025-10-14 02:03:03.802679', 45084.01314717845, 0.26422798528303615, 'sell', 'limit'), ('2025-10-14 02:13:10.252007', 45056.42061151626, 0.8807098677906374, 'sell', 'market'), ('2025-10-14 02:04:11.124444', 45020.074997561205, 1.7620884833920376, 'buy', 'market'), ('2025-10-14 02:04:02.801397', 45008.104468615005, 1.9858590658562303, 'sell', 'market'), ('2025-10-14 02:13:09.371115', 45007.82027582385, 1.4231457955256728, 'sell', 'market'), ('2025-10-14 02:10:54.805047', 44984.33258703328, 1.254144678809665, 'buy', 'market'), ('2025-10-14 02:11:56.306666', 44956.42441747339, 1.3344663562932593, 'sell', 'market'), ('2025-10-14 02:04:37.921669', 44954.11460103985, 0.4001542554597856, 'sell', 'market'), ('2025-10-14 02:09:06.203733', 44942.26979197722, 1.5345914845092605, 'sell', 'market'), ('2025-10-14 02:12:31.838927', 45031.8464559234, 1.7835359237592265, 'sell', 'market'), ('2025-10-14 02:05:54.320152', 45044.406119615785, 0.06975725257222747, 'buy', 'market'), ('2025-10-14 02:14:54.267081', 45017.95093527219, 0.8959839979250553, 'sell', 'limit'), ('2025-10-14 02:09:06.401459', 45041.09461435119, 0.4176276588783355, 'buy', 'market'), ('2025-10-14 02:12:03.835971', 45053.60173237959, 0.12011255932330794, 'sell', 'market'), ('2025-10-14 02:12:21.208224', 45069.722467363834, 1.558602419542156, 'buy', 'market'), ('2025-10-14 02:07:48.716429', 45060.39286361844, 1.172009107504755, 'sell', 'market'), ('2025-10-14 02:10:40.243074', 45093.43536528962, 0.7773149690917491, 'buy', 'market'), ('2025-10-14 02:13:53.026569', 45054.09822704117, 1.6612262783602914, 'sell', 'market'), ('2025-10-14 02:16:21.264453', 45038.5622369985, 0.8924652009252101, 'sell', 'market'), ('2025-10-14 02:10:38.689217', 45117.491607198834, 0.02582557748783009, 'sell', 'limit'), ('2025-10-14 02:13:26.374038', 45117.10466829264, 1.9881164112102545, 'sell', 'market'), ('2025-10-14 02:08:53.064509', 45088.537619151044, 0.09346124369894965, 'buy', 'market'), ('2025-10-14 02:17:27.002199', 45059.449848413475, 1.586307464958019, 'sell', 'market'), ('2025-10-14 02:04:33.660069', 45099.736676437395, 1.1122341333760437, 'sell', 'market'), ('2025-10-14 02:15:28.276254', 45127.67318531967, 1.931055989448801, 'buy', 'market'), ('2025-10-14 02:05:29.009563', 45066.021442633384, 0.1813938021632842, 'sell', 'market'), ('2025-10-14 02:15:31.396416', 45099.91121282823, 0.8988538140781397, 'sell', 'market')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:02:54.178 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 03:02:54.168964', 43176.93, 4.20529995, 'sell', 'market')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:02:54.185 | WARNING  | fullon_ohlcv_service.config.database_config | 60 | Category exchange not found for cat_ex_id 1
2025-10-14 03:02:54.185 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 03:02:54.203 | WARNING  | fullon_ohlcv_service.config.database_config | 60 | Category exchange not found for cat_ex_id 1
2025-10-14 03:02:54.204 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 03:02:54.211 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 03:02:00.000000', 34090.55, 34834.04264825173, 33495.36711691566, 34340.065694751465, 6561.7078)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:02:54.216 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-13 17:00:00.000000', 32535.48, 33525.38707911768, 31613.206995655408, 33170.98581487461, 8625.6693), ('2025-10-13 18:00:00.000000', 31312.87, 31478.629502104588, 31059.21781727689, 31079.59222794635, 5798.1761), ('2025-10-13 19:00:00.000000', 37003.24, 37255.87833535033, 36180.859190018076, 36877.69894388367, 5080.5321), ('2025-10-13 20:00:00.000000', 34439.31, 34870.50871617315, 34361.662349134465, 34447.011276952275, 5414.0881), ('2025-10-13 21:00:00.000000', 32194.06, 32533.758131107224, 31880.48900780989, 32426.274079416144, 3086.5462), ('2025-10-13 22:00:00.000000', 34555.03, 34648.98461578057, 34400.33767409944, 34429.997235256844, 2774.5679), ('2025-10-13 23:00:00.000000', 42887.59, 43048.02915164978, 42030.73326353889, 42869.190009710066, 970.7812), ('2025-10-14 00:00:00.000000', 46287.05, 46933.50402730534, 45296.91814527582, 46120.099778057025, 4771.865), ('2025-10-14 01:00:00.000000', 38538.2, 39008.942759354766, 38390.32751497622, 38736.3476402921, 9362.5511), ('2025-10-14 02:00:00.000000', 35348.76, 35998.686756653515, 34935.64045295517, 35798.49305981885, 5267.02)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:02:54.216 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 03:02:00.000000', 42704.22, 42931.209284183715, 42659.73133789378, 42757.96524645936, 9977.8007)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:02:54.216 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 03:02:00.000000', 39682.39, 39966.9171422875, 39114.63248001623, 39618.89186744494, 3520.0345)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:02:54.235 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 03:02:54.235 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 03:02:54.236 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 03:02:54.237 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 03:02:54.238 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 03:02:54.239 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:02:54.241 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:02:54.252 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 03:02:34.227266', 33484.1, 0.38045646, 'sell', 'market'), ('2025-10-14 03:02:35.227266', 37012.58, 4.55647687, 'buy', 'limit'), ('2025-10-14 03:02:36.227266', 41471.7, 5.31121108, 'sell', 'market'), ('2025-10-14 03:02:37.227266', 47167.35, 9.23792703, 'buy', 'limit'), ('2025-10-14 03:02:38.227266', 39973.43, 3.84746978, 'buy', 'limit'), ('2025-10-14 03:02:39.227266', 40548.25, 4.15541125, 'buy', 'limit'), ('2025-10-14 03:02:40.227266', 46139.87, 0.25770817, 'sell', 'limit'), ('2025-10-14 03:02:41.227266', 33449.79, 0.06643, 'sell', 'market'), ('2025-10-14 03:02:42.227266', 33687.81, 3.60062424, 'buy', 'limit'), ('2025-10-14 03:02:43.227266', 38118.81, 1.75256503, 'buy', 'limit'), ('2025-10-14 03:02:44.227266', 39983.43, 2.71549013, 'sell', 'limit'), ('2025-10-14 03:02:45.227266', 47364.14, 6.72147202, 'buy', 'limit'), ('2025-10-14 03:02:46.227266', 48646.78, 2.30123851, 'buy', 'limit'), ('2025-10-14 03:02:47.227266', 36205.97, 1.07295669, 'sell', 'limit'), ('2025-10-14 03:02:48.227266', 44309.32, 3.88728728, 'sell', 'limit'), ('2025-10-14 03:02:49.227266', 31802.32, 7.31233268, 'sell', 'market'), ('2025-10-14 03:02:50.227266', 31680.41, 1.84694398, 'buy', 'market'), ('2025-10-14 03:02:51.227266', 48907.52, 1.80587458, 'sell', 'limit'), ('2025-10-14 03:02:52.227266', 39222.15, 5.07329403, 'sell', 'limit'), ('2025-10-14 03:02:53.227266', 30156.41, 5.51343342, 'sell', 'market')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:02:54.269 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 03:02:00.000000', 36806.48, 37616.39018740971, 36458.07323085826, 37420.77125939811, 8854.0131)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:02:54.311 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:02:54.311 | INFO     | fullon_ohlcv_service.trade.historic_collector | 215 | Exchange has native OHLCV support - skipping trade collection exchange=kraken symbol_count=1
2025-10-14 03:02:54.333 | WARNING  | fullon_ohlcv_service.ohlcv.historic_collector | 436 | Skipping candle with None values raw_candle=[1640995260000, None, 51500, 49500, 51000, 150]
2025-10-14 03:02:54.336 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:02:54.336 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 03:02:54.337 | INFO     | fullon_cache.event_loop | 134 | Event loop configured: uvloop
2025-10-14 03:02:54.338 | INFO     | fullon_cache.connection | 121 | uvloop configured for optimal Redis performance
2025-10-14 03:02:54.344 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:02:54.347 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:02:54.353 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 03:02:54.358 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:02:54.359 | WARNING  | fullon_ohlcv_service.daemon | 230 | Error stopping collector during cleanup error=Stop failed
2025-10-14 03:02:54.360 | WARNING  | fullon_ohlcv_service.ohlcv.live_collector | 42 | Live collection already running
2025-10-14 03:02:54.360 | WARNING  | fullon_ohlcv_service.daemon | 242 | Failed to update ProcessCache during cleanup error=Cache update failed
2025-10-14 03:02:54.362 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:02:54.371 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:02:54.372 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 03:02:54.376 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 74 | Stopping live OHLCV collection
2025-10-14 03:02:54.384 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 03:02:54.391 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 86 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 03:02:54.391 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 03:02:54.392 | WARNING  | fullon_ohlcv_service.daemon | 75 | No symbols found in database - nothing to collect
2025-10-14 03:02:54.393 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:02:54.393 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:02:54.396 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:02:54.396 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 200 | Failed to get REST handler for exchange exchange=kraken error=Handler creation failed
2025-10-14 03:02:54.402 | WARNING  | fullon_ohlcv_service.ohlcv.historic_collector | 68 | Historical collection already running
2025-10-14 03:02:54.406 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:02:54.413 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 169 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 03:02:54.434 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 72 | Starting historical OHLCV collection
2025-10-14 03:02:54.434 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 114 | Historical collection completed total_symbols=0 total_candles=0
2025-10-14 03:02:54.441 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 72 | Starting historical OHLCV collection
2025-10-14 03:02:54.442 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=binance symbol_count=1
2025-10-14 03:02:54.442 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 199 | Failed to get REST handler for exchange exchange=binance error=object MagicMock can't be used in 'await' expression
2025-10-14 03:02:54.443 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 114 | Historical collection completed total_symbols=0 total_candles=0
2025-10-14 03:02:54.462 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 291 | Symbol already collecting symbol_key=binance:BTC/USDT
2025-10-14 03:02:54.473 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=ETH/USDT
2025-10-14 03:02:54.475 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 353 | Added symbol to collector symbol=ETH/USDT exchange=binance
2025-10-14 03:02:54.484 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 356 | Creating new handler exchange=binance symbol=BTC/USDT
2025-10-14 03:02:54.497 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=BTC/USDT
2025-10-14 03:02:54.498 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 353 | Added symbol to collector symbol=BTC/USDT exchange=binance
2025-10-14 03:02:54.505 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=BTC/USDT
2025-10-14 03:02:54.505 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 317 | Exchange needs trades for OHLCV, skipping exchange=binance symbol=BTC/USDT
2025-10-14 03:02:54.502 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 03:02:54.505 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 03:02:54.506 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 03:02:54.511 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.507 | ERROR    | fullon_ohlcv_service.daemon | 119 | Daemon error error=OHLCV collection failed
2025-10-14 03:02:54.507 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:02:54.508 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:02:54.510 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:02:54.510 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:02:54.516 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.520 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.529 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.538 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.547 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.551 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.556 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.557 | INFO     | fullon_ohlcv_service.trade.batcher | 105 | Batch processing started
2025-10-14 03:02:54.564 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.564 | INFO     | fullon_ohlcv_service.trade.batcher | 87 | Symbol unregistered from batch processing exchange=kraken symbol=ETH/USD remaining_symbols=2
2025-10-14 03:02:54.572 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:02:54.573 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 122 | Exchange requires trade collection instead of OHLCV - skipping OHLCV subscription exchange=binance symbol_count=1
2025-10-14 03:02:54.573 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.574 | INFO     | fullon_ohlcv_service.trade.batcher | 105 | Batch processing started
2025-10-14 03:02:54.579 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:02:54.581 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 122 | Exchange requires trade collection instead of OHLCV - skipping OHLCV subscription exchange=binance symbol_count=1
2025-10-14 03:02:54.588 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.588 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:02:54.589 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 132 | Exchange supports native OHLCV - proceeding with subscription exchange=binance symbol_count=1
2025-10-14 03:02:54.589 | INFO     | fullon_cache.event_loop | 134 | Event loop configured: uvloop
2025-10-14 03:02:54.590 | INFO     | fullon_cache.connection | 121 | uvloop configured for optimal Redis performance
2025-10-14 03:02:54.595 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.596 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 166 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 03:02:54.597 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 183 | Finished subscribing to OHLCV exchange=binance symbol_count=1
2025-10-14 03:02:54.605 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.612 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='126986794109648'>
2025-10-14 03:02:54.614 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='126986794109984'>
2025-10-14 03:02:54.618 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='126986794109648'>
2025-10-14 03:02:54.618 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='126986794109984'>
2025-10-14 03:02:54.619 | INFO     | fullon_ohlcv_service.trade.batcher | 257 | Batch cycle completed - no trades to process total_symbols=2 duration_seconds=0.01
2025-10-14 03:02:54.641 | ERROR    | fullon_ohlcv_service.ohlcv.live_collector | 238 | Error processing OHLCV exchange=binance symbol=BTC/USDT error=not enough values to unpack (expected 6, got 1)
2025-10-14 03:02:54.664 | INFO     | fullon_ohlcv_service.trade.historic_collector | 169 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 03:02:54.669 | INFO     | fullon_ohlcv_service.daemon | 171 | Starting two-phase collection for single symbol symbol=BTC/USDC exchange=kraken
2025-10-14 03:02:54.669 | INFO     | fullon_ohlcv_service.daemon | 180 | Phase 1: Starting historic collection
2025-10-14 03:02:54.670 | INFO     | fullon_ohlcv_service.daemon | 188 | Phase 1: Historic collection completed
2025-10-14 03:02:54.670 | INFO     | fullon_ohlcv_service.daemon | 197 | Phase 2: Starting live streaming
2025-10-14 03:02:54.671 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDC
2025-10-14 03:02:54.675 | WARNING  | fullon_ohlcv_service.trade.historic_collector | 69 | Historical collection already running
2025-10-14 03:02:54.678 | INFO     | fullon_ohlcv_service.trade.historic_collector | 73 | Starting historical trade collection
2025-10-14 03:02:54.679 | WARNING  | fullon_ohlcv_service.trade.historic_collector | 92 | No admin exchange found for collection exchange=binance
2025-10-14 03:02:54.679 | INFO     | fullon_ohlcv_service.trade.historic_collector | 115 | Historical collection completed total_symbols=0 total_trades=0
2025-10-14 03:02:54.685 | INFO     | fullon_ohlcv_service.trade.historic_collector | 73 | Starting historical trade collection
2025-10-14 03:02:54.685 | INFO     | fullon_ohlcv_service.trade.historic_collector | 115 | Historical collection completed total_symbols=0 total_trades=0
2025-10-14 03:02:54.691 | WARNING  | fullon_ohlcv_service.trade.live_collector | 43 | Live collection already running
2025-10-14 03:02:54.699 | INFO     | fullon_ohlcv_service.trade.live_collector | 75 | Stopping live trade collection
2025-10-14 03:02:54.703 | INFO     | fullon_ohlcv_service.trade.live_collector | 94 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 03:02:54.720 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:02:54.721 | WARNING  | fullon_ohlcv_service.trade.live_collector | 166 | Failed to subscribe to trades exchange=binance symbol=BTC/USDT error=Subscription failed
2025-10-14 03:02:54.721 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 03:02:54.722 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:02:54.723 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 03:02:54.724 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 03:02:54.739 | WARNING  | fullon_ohlcv_service.trade.live_collector | 192 | Trade object missing symbol attribute exchange=binance trade_obj=<Mock id='126986792418816'>
2025-10-14 03:02:54.741 | ERROR    | fullon_ohlcv_service.trade.live_collector | 225 | Error processing trade exchange=binance error=Cache error
2025-10-14 03:02:54.760 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:02:54.762 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 03:02:54.762 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:02:54.762 | INFO     | fullon_ohlcv_service.trade.batcher | 105 | Batch processing started
2025-10-14 03:02:54.763 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 03:02:54.769 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:02:54.771 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=ETH/USDT success=True
2025-10-14 03:02:54.772 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 03:02:54.787 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:02:54.787 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:02:54.789 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 03:02:54.790 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 03:02:54.788 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 03:02:54.789 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol kraken:BTC/USDC'
2025-10-14 03:02:54.832 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=1 total_symbols=1
2025-10-14 03:02:54.833 | ERROR    | fullon_ohlcv.repositories.ohlcv.base_repository | 426 | Failed to create hypertable for kraken.btc_usdc_trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedFunctionError'>: function create_hypertable(regclass, unknown, if_not_exists => boolean) does not exist
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[SQL: 
                    SELECT create_hypertable(
                        'kraken.btc_usdc_trades'::regclass,
                        'timestamp',
                        if_not_exists => TRUE
                    )
                ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:02:54.841 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 40 | Failed to initialize symbol kraken:BTC/USDC
2025-10-14 03:02:54.841 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 95 | Failed to initialize symbol kraken:BTC/USDC
2025-10-14 03:02:54.841 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 0/1 successful
2025-10-14 03:02:54.842 | WARNING  | fullon_ohlcv_service.daemon | 145 | Symbol initialization failed - continuing anyway symbol=BTC/USDC exchange=kraken
2025-10-14 03:02:54.843 | ERROR    | fullon_ohlcv_service.daemon | 207 | Daemon in inconsistent state - cannot proceed
2025-10-14 03:02:54.883 | INFO     | fullon_ohlcv_service.daemon | 171 | Starting two-phase collection for single symbol symbol=BTC/USDT exchange=binance
2025-10-14 03:02:54.884 | INFO     | fullon_ohlcv_service.daemon | 180 | Phase 1: Starting historic collection
2025-10-14 03:02:54.886 | INFO     | fullon_ohlcv_service.daemon | 188 | Phase 1: Historic collection completed
2025-10-14 03:02:54.887 | INFO     | fullon_ohlcv_service.daemon | 197 | Phase 2: Starting live streaming
2025-10-14 03:02:54.888 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 03:02:54.897 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:02:54.898 | INFO     | fullon_ohlcv_service.trade.historic_collector | 215 | Exchange has native OHLCV support - skipping trade collection exchange=kraken symbol_count=1
2025-10-14 03:02:54.926 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:02:54.927 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 03:02:54.929 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 03:02:54.955 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:02:54.956 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 03:02:54.958 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 03:02:54.986 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:02:54.987 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 03:02:54.989 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 353 | Error collecting batch for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 03:02:54.990 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 242 | Historical collection failed for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 03:02:54.994 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 03:02:54.995 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 03:02:55.029 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:02:55.030 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 03:02:55.032 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 241 | Historical collection completed for symbol symbol=kraken:BTC/USD candles_collected=0
2025-10-14 03:02:55.123 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:02:55.123 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 03:02:55.126 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 241 | Historical collection completed for symbol symbol=kraken:BTC/USD candles_collected=0
2025-10-14 03:02:55.143 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:02:55.143 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 03:02:55.144 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 364 | Error collecting batch for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 03:02:55.145 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 235 | Historical collection failed for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 03:04:01.695 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:04:02.876 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:04:02.885 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:04:02.913 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:04:02.916 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:04:03.507 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 03:04:03.532 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 03:04:03.638 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 03:04:03.659 | INFO     | fullon_exchange.queue.exchange_queue | 101 | ✅ Patched asyncio.run() at module import for automatic clean shutdown
2025-10-14 03:04:03.884 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 03:04:03.885 | INFO     | fullon_ohlcv_service.utils.add_symbols | 37 | Successfully initialized symbol binance:BTC/USDT
2025-10-14 03:04:03.892 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 03:04:03.895 | INFO     | fullon_ohlcv_service.utils.add_symbols | 131 | Found 2 symbols for exchange binance
2025-10-14 03:04:03.896 | INFO     | fullon_ohlcv_service.utils.add_symbols | 143 | Exchange binance initialization: 1/2 successful
2025-10-14 03:04:03.896 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 03:04:03.898 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 44 | Error initializing symbol binance:BTC/USDT: Init failed
2025-10-14 03:04:03.905 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 03:04:03.906 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 147 | Error initializing symbols for exchange binance: Database error
2025-10-14 03:04:03.905 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol binance:BTC/USDT'
2025-10-14 03:04:03.906 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 44 | Error initializing symbol binance:BTC/USDT: Repository creation failed
2025-10-14 03:04:03.918 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:04:03.918 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 2 symbols to initialize
2025-10-14 03:04:03.919 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 2/2 successful
2025-10-14 03:04:03.927 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:04:03.932 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 03:04:03.935 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/1 successful
2025-10-14 03:04:03.943 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:04:03.945 | WARNING  | fullon_ohlcv_service.utils.add_symbols | 72 | No symbols found
2025-10-14 03:04:03.948 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 03:04:03.949 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=2
2025-10-14 03:04:03.950 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 03:04:03.951 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 03:04:03.952 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:04:03.953 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 2 symbols to initialize
2025-10-14 03:04:03.954 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 95 | Failed to initialize symbol <MagicMock name='mock.exchange_name' id='140026367562752'>:ETH/USDT
2025-10-14 03:04:03.956 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/2 successful
2025-10-14 03:04:03.952 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 03:04:03.952 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:04:03.952 | INFO     | fullon_ohlcv_service.trade.live_collector | 75 | Stopping live trade collection
2025-10-14 03:04:03.953 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:03.957 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:04:03.961 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:04:03.961 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 102 | Error during bulk symbol initialization: Database connection failed
2025-10-14 03:04:03.967 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:04:03.967 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 03:04:03.968 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 1/1 successful
2025-10-14 03:04:03.979 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 03:04:03.980 | INFO     | fullon_ohlcv_service.utils.add_symbols | 131 | Found 2 symbols for exchange binance
2025-10-14 03:04:03.980 | INFO     | fullon_ohlcv_service.utils.add_symbols | 143 | Exchange binance initialization: 2/2 successful
2025-10-14 03:04:03.986 | INFO     | fullon_ohlcv_service.utils.add_symbols | 121 | Initializing all symbols for exchange: binance
2025-10-14 03:04:03.988 | WARNING  | fullon_ohlcv_service.utils.add_symbols | 128 | No symbols found for exchange binance
2025-10-14 03:04:04.061 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 03:04:04.062 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 03:04:04.063 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 03:04:04.064 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 03:04:04.065 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 03:04:04.066 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:04:04.067 | WARNING  | fullon_ohlcv_service.daemon | 230 | Error stopping collector during cleanup error=object MagicMock can't be used in 'await' expression
2025-10-14 03:04:04.067 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:04:04.121 | INFO     | fullon_ohlcv_service.daemon | 155 | Symbol already collecting symbol=BTC/USDT
2025-10-14 03:04:04.130 | INFO     | fullon_ohlcv_service.daemon | 159 | Symbol already collecting symbol=BTC/USDT
2025-10-14 03:04:04.138 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 03:04:04.138 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 03:04:04.148 | WARNING  | fullon_ohlcv_service.daemon | 145 | Symbol initialization failed - continuing anyway symbol=BTC/USDT exchange=binance
2025-10-14 03:04:04.149 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 03:04:04.150 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 03:04:04.158 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 03:04:00.000000', 44529.03, 45152.65930407003, 44058.87498767711, 44873.70581375949, 4577.5841)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:04:04.166 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 03:04:04.167 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 03:04:04.171 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-13 03:00:00.000000', 50000.0, 50243.68, 49702.48, 49872.82, 609.165), ('2025-10-13 04:00:00.000000', 49872.82, 50089.77, 49532.53, 49544.22, 574.8708), ('2025-10-13 05:00:00.000000', 49544.22, 49772.21, 49165.34, 49602.41, 1215.1137), ('2025-10-13 06:00:00.000000', 49602.41, 49888.08, 49225.73, 49696.36, 620.7837), ('2025-10-13 07:00:00.000000', 49696.36, 49997.34, 49353.98, 49405.92, 1010.1902), ('2025-10-13 08:00:00.000000', 49405.92, 49843.9, 49142.13, 49814.34, 895.9223), ('2025-10-13 09:00:00.000000', 49814.34, 50144.1, 49644.06, 49885.26, 1076.0835), ('2025-10-13 10:00:00.000000', 49885.26, 49905.62, 49643.29, 49739.04, 791.6452), ('2025-10-13 11:00:00.000000', 49739.04, 49809.92, 49661.95, 49782.65, 1494.9996), ('2025-10-13 12:00:00.000000', 49782.65, 49956.75, 49303.57, 49413.99, 1067.6242), ('2025-10-13 13:00:00.000000', 49413.99, 49495.68, 49160.95, 49310.85, 1482.652), ('2025-10-13 14:00:00.000000', 49310.85, 49569.99, 49296.92, 49453.66, 1535.3507), ('2025-10-13 15:00:00.000000', 49453.66, 49818.57, 49007.63, 49419.61, 904.7969), ('2025-10-13 16:00:00.000000', 49419.61, 49498.23, 49136.46, 49326.94, 1454.5908), ('2025-10-13 17:00:00.000000', 49326.94, 49659.28, 49039.41, 49207.35, 944.7448), ('2025-10-13 18:00:00.000000', 49207.35, 49448.57, 48727.12, 49326.17, 653.834), ('2025-10-13 19:00:00.000000', 49326.17, 49329.14, 48910.65, 49061.87, 1451.5617), ('2025-10-13 20:00:00.000000', 49061.87, 49309.88, 49006.73, 49086.87, 1418.5191), ('2025-10-13 21:00:00.000000', 49086.87, 49361.94, 48747.88, 49247.95, 1328.0103), ('2025-10-13 22:00:00.000000', 49247.95, 49711.49, 48852.61, 49398.28, 1482.0286), ('2025-10-13 23:00:00.000000', 49398.28, 49607.34, 49157.2, 49467.16, 1053.4992), ('2025-10-14 00:00:00.000000', 49467.16, 49595.33, 49375.57, 49545.43, 1505.1822), ('2025-10-14 01:00:00.000000', 49545.43, 50017.47, 49472.28, 49949.16, 722.9556), ('2025-10-14 02:00:00.000000', 49949.16, 49969.38, 49568.32, 49610.31, 839.4757)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:04:04.178 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 03:04:04.179 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 03:04:04.180 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 03:04:04.181 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 03:04:04.181 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 03:04:04.182 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:04:04.184 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:04:04.185 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=2 total_symbols=4
2025-10-14 03:04:04.198 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 02:04:04.130671', 45000.0, 1.5736814081561836, 'buy', 'limit'), ('2025-10-14 02:04:06.308845', 45052.591295056685, 0.49467765054167356, 'buy', 'market'), ('2025-10-14 02:04:19.984035', 44978.77062645848, 1.9827574782749495, 'sell', 'market'), ('2025-10-14 02:04:22.361884', 45032.835946133775, 0.5440973070986247, 'buy', 'market'), ('2025-10-14 02:04:18.002039', 45058.84601352095, 1.9708092507580273, 'buy', 'limit'), ('2025-10-14 02:04:25.228716', 45017.221674170956, 1.8824079478746356, 'sell', 'limit'), ('2025-10-14 02:04:52.220893', 45000.931171023396, 1.787191663276924, 'sell', 'market'), ('2025-10-14 02:04:22.779427', 45012.19578959337, 0.1782657013653232, 'buy', 'limit'), ('2025-10-14 02:04:38.704575', 44988.48867650598, 1.5307486995749633, 'sell', 'limit'), ('2025-10-14 02:04:40.935442', 45036.78364752006, 1.802326793096279, 'buy', 'market'), ('2025-10-14 02:04:08.531151', 45064.6336311678, 0.9263802950516988, 'sell', 'market'), ('2025-10-14 02:05:45.548317', 45048.991867042554, 1.9058339998946736, 'sell', 'market'), ('2025-10-14 02:04:35.767339', 45030.957603957395, 0.9837734889974269, 'sell', 'market'), ('2025-10-14 02:06:06.511280', 45093.258912332065, 0.19406053458941078, 'buy', 'market'), ('2025-10-14 02:04:30.229457', 45078.602794570135, 0.571795544376648, 'buy', 'market'), ('2025-10-14 02:05:23.863561', 45060.52312339435, 1.7259541346999814, 'sell', 'limit'), ('2025-10-14 02:06:10.752143', 45093.71116138157, 1.3834400102894524, 'buy', 'market'), ('2025-10-14 02:06:29.312592', 45029.83119743067, 1.6045868911036014, 'buy', 'market'), ('2025-10-14 02:06:03.877543', 44998.76596664268, 1.6632935822666197, 'buy', 'market'), ('2025-10-14 02:06:06.892464', 44974.34865970145, 0.4879404344845433, 'sell', 'market'), ('2025-10-14 02:06:23.139591', 44929.97829576924, 1.216378862242607, 'sell', 'market'), ('2025-10-14 02:05:05.551828', 44979.46746334454, 0.7615859388316452, 'buy', 'market'), ('2025-10-14 02:07:12.036807', 44935.91047818333, 1.6148599854215568, 'sell', 'limit'), ('2025-10-14 02:05:31.478484', 44978.3298802159, 0.9457002314727254, 'sell', 'market'), ('2025-10-14 02:04:36.905575', 44975.12369938032, 1.4148088205199845, 'buy', 'limit'), ('2025-10-14 02:08:04.097671', 44868.48718106509, 0.24968655802924436, 'buy', 'market'), ('2025-10-14 02:05:26.626071', 44779.92606536553, 0.4378266648045042, 'sell', 'market'), ('2025-10-14 02:07:56.122339', 44781.46516189205, 1.744469851968359, 'buy', 'market'), ('2025-10-14 02:06:08.318987', 44795.92800564047, 0.028405873146592826, 'buy', 'market'), ('2025-10-14 02:08:02.412593', 44777.2216402528, 1.1205343270530208, 'sell', 'market'), ('2025-10-14 02:06:57.010801', 44777.35680241591, 1.554212964916891, 'buy', 'market'), ('2025-10-14 02:04:20.616595', 44777.59917461067, 0.6138916983777946, 'buy', 'limit'), ('2025-10-14 02:07:32.837775', 44825.84531924563, 0.8506637411609933, 'buy', 'limit'), ('2025-10-14 02:04:40.179673', 44898.261517910294, 1.1099683319699492, 'sell', 'market'), ('2025-10-14 02:08:57.013573', 44863.92089627257, 0.12427581502768324, 'sell', 'market'), ('2025-10-14 02:04:27.358071', 44813.08011685755, 0.8295308462969269, 'sell', 'market'), ('2025-10-14 02:06:04.783843', 44797.64855878249, 0.554444023559012, 'sell', 'market'), ('2025-10-14 02:04:18.432725', 44815.550339105175, 0.14745170596129184, 'sell', 'market'), ('2025-10-14 02:04:31.928355', 44809.130297762764, 1.6501211884363194, 'sell', 'limit'), ('2025-10-14 02:05:28.332919', 44843.504695831434, 0.9319284491337481, 'buy', 'market'), ('2025-10-14 02:10:08.709711', 44892.284189542486, 1.6275069130734163, 'sell', 'market'), ('2025-10-14 02:04:18.035206', 44896.500158002294, 1.4430284840435232, 'buy', 'limit'), ('2025-10-14 02:09:33.868471', 44932.72947767905, 1.9868296674147623, 'buy', 'market'), ('2025-10-14 02:07:52.939648', 44952.05274558228, 1.9521902692532245, 'buy', 'market'), ('2025-10-14 02:11:19.567607', 44959.11888661782, 0.3363783048595348, 'sell', 'market'), ('2025-10-14 02:07:14.117566', 44959.86988027162, 1.03314577442744, 'sell', 'limit'), ('2025-10-14 02:08:44.033679', 44954.38761169499, 0.3088508602343516, 'buy', 'market'), ('2025-10-14 02:06:16.341765', 45005.49602278221, 1.0508576608660682, 'buy', 'market'), ('2025-10-14 02:06:16.960207', 45041.85410031285, 0.43449216900777965, 'sell', 'market'), ('2025-10-14 02:07:21.558090', 45077.3790639574, 0.28669882165840904, 'buy', 'market'), ('2025-10-14 02:08:48.083321', 45139.82225434674, 0.8655103813586617, 'buy', 'market'), ('2025-10-14 02:12:26.903104', 45114.4136002544, 0.12475442288280213, 'buy', 'market'), ('2025-10-14 02:11:40.455683', 45117.718171126355, 0.028189984566742432, 'buy', 'market'), ('2025-10-14 02:11:36.045347', 45120.0944801894, 0.7766161745303972, 'buy', 'market'), ('2025-10-14 02:06:07.142347', 45144.78843431239, 0.21857836612892756, 'buy', 'market'), ('2025-10-14 02:09:55.980686', 45108.49822112108, 0.45549178527207584, 'buy', 'market'), ('2025-10-14 02:07:43.162351', 45125.08410455077, 0.05139989849813056, 'buy', 'limit'), ('2025-10-14 02:06:18.500989', 45131.020662641735, 0.9828797013755852, 'buy', 'market'), ('2025-10-14 02:13:21.851131', 45060.34781440618, 1.786900756688281, 'sell', 'limit'), ('2025-10-14 02:10:23.618730', 44949.602457984955, 0.6457206967747737, 'sell', 'market'), ('2025-10-14 02:04:55.714891', 44945.817938442, 0.5969666174437342, 'sell', 'market'), ('2025-10-14 02:05:12.822039', 44911.31542276345, 0.09415817468712699, 'sell', 'market'), ('2025-10-14 02:11:10.076995', 44957.232951095, 1.939249460680418, 'buy', 'limit'), ('2025-10-14 02:11:51.130834', 44990.18152093922, 0.7069081502093592, 'sell', 'market'), ('2025-10-14 02:07:12.935023', 45021.34751075114, 1.1109466515081254, 'buy', 'market'), ('2025-10-14 02:04:31.352281', 45033.38851710922, 1.0925091133572395, 'buy', 'market'), ('2025-10-14 02:08:56.068405', 45017.67396332111, 1.5365676919852456, 'sell', 'market'), ('2025-10-14 02:09:55.129467', 45027.28445999718, 0.16722462447466763, 'buy', 'market'), ('2025-10-14 02:15:07.293395', 45061.398497973336, 0.11207686839834402, 'buy', 'market'), ('2025-10-14 02:13:06.489991', 45076.62468691609, 0.8435160989584187, 'buy', 'market'), ('2025-10-14 02:05:22.374501', 45079.90439335842, 0.41985059683020554, 'buy', 'market'), ('2025-10-14 02:09:30.854566', 45181.93631365087, 0.6627769509161284, 'buy', 'market'), ('2025-10-14 02:05:05.990047', 45245.836578093214, 0.5598369445823551, 'sell', 'market'), ('2025-10-14 02:15:06.368567', 45140.20489639404, 0.4212680438339101, 'buy', 'market'), ('2025-10-14 02:07:56.571627', 45139.80930127459, 0.7580728854040486, 'sell', 'market'), ('2025-10-14 02:05:43.582546', 45129.57468494396, 1.4395883933955391, 'buy', 'market'), ('2025-10-14 02:04:44.572627', 45094.85255361223, 1.8913372815603668, 'sell', 'limit'), ('2025-10-14 02:11:31.434682', 45112.402881131515, 0.47979086979543656, 'buy', 'limit'), ('2025-10-14 02:14:36.471679', 45157.614020792134, 0.4247434425786887, 'buy', 'market'), ('2025-10-14 02:06:15.038411', 45145.53121513454, 0.997782874834295, 'sell', 'market'), ('2025-10-14 02:06:31.800511', 45114.9565504553, 0.5916104809115977, 'sell', 'market'), ('2025-10-14 02:07:43.239073', 45130.10390376258, 1.4413143342331687, 'buy', 'market'), ('2025-10-14 02:07:19.423265', 45127.81903956904, 0.9137309867003915, 'sell', 'market'), ('2025-10-14 02:08:39.579451', 45052.895440706845, 0.8427978238924112, 'buy', 'market'), ('2025-10-14 02:16:16.294915', 45129.450939712115, 0.31447472328651177, 'buy', 'market'), ('2025-10-14 02:06:44.280531', 45115.7156708731, 0.018782417064106903, 'sell', 'market'), ('2025-10-14 02:17:08.835005', 45156.27165983905, 1.7168601750395711, 'buy', 'market'), ('2025-10-14 02:06:00.971845', 45214.15418073943, 0.057784311461548624, 'buy', 'market'), ('2025-10-14 02:08:28.879375', 45250.81989578126, 0.41680218651204864, 'buy', 'market'), ('2025-10-14 02:11:17.670853', 45306.14343201354, 0.04485937562480735, 'buy', 'market'), ('2025-10-14 02:12:46.963891', 45365.02288289543, 0.6936442537718343, 'buy', 'market'), ('2025-10-14 02:05:58.479269', 45363.25242950438, 0.20082410346812818, 'sell', 'market'), ('2025-10-14 02:15:52.272243', 45315.006338573, 1.8975853428570801, 'sell', 'market'), ('2025-10-14 02:18:42.392260', 45213.31447514729, 0.29128850380327875, 'sell', 'market'), ('2025-10-14 02:08:50.597645', 45233.41972859571, 0.3939865084643501, 'buy', 'market'), ('2025-10-14 02:19:20.122476', 45291.80445519098, 1.1833087864095957, 'sell', 'market'), ('2025-10-14 02:09:27.535183', 45313.65827613943, 0.9211411145375775, 'buy', 'market'), ('2025-10-14 02:18:44.156187', 45296.564901890364, 1.7212986636170595, 'sell', 'market'), ('2025-10-14 02:14:15.080801', 45276.195999136675, 1.8645457680122763, 'buy', 'market'), ('2025-10-14 02:17:15.894259', 45289.08907207037, 1.66876945600228, 'buy', 'market')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:04:04.196 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 03:04:04.173629', 44496.93, 7.40541251, 'sell', 'limit')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:04:04.204 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 03:04:04.218 | WARNING  | fullon_ohlcv_service.config.database_config | 60 | Category exchange not found for cat_ex_id 1
2025-10-14 03:04:04.218 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 03:04:04.232 | WARNING  | fullon_ohlcv_service.config.database_config | 60 | Category exchange not found for cat_ex_id 1
2025-10-14 03:04:04.234 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=0 total_symbols=0
2025-10-14 03:04:04.233 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-13 17:00:00.000000', 38631.55, 39272.389473713905, 37711.437922468074, 38021.911596870785, 3510.0819), ('2025-10-13 18:00:00.000000', 30899.75, 31603.638638940847, 30815.82399561718, 31531.040581630485, 7912.5862), ('2025-10-13 19:00:00.000000', 47552.59, 47646.77748491805, 47274.83833432097, 47556.432626947324, 7006.5018), ('2025-10-13 20:00:00.000000', 38668.96, 39543.80596007125, 38596.45091556013, 39186.68633443459, 7498.0385), ('2025-10-13 21:00:00.000000', 49828.01, 50210.618988223185, 49437.172542198365, 49723.51891440627, 4818.7785), ('2025-10-13 22:00:00.000000', 46544.98, 47215.46250120974, 45638.483380000645, 46797.75655581624, 9437.0914), ('2025-10-13 23:00:00.000000', 48750.04, 48817.563206899205, 47778.731217193264, 48789.45646452315, 6860.525), ('2025-10-14 00:00:00.000000', 30364.04, 30547.692149707735, 30339.178463590608, 30420.399795306505, 8287.5404), ('2025-10-14 01:00:00.000000', 37049.28, 37405.03418278072, 36474.24845418266, 37398.36408608391, 7405.9899), ('2025-10-14 02:00:00.000000', 31716.58, 32295.927304703928, 31236.7978137261, 31253.56263400787, 3089.4793)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:04:04.252 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 03:04:00.000000', 46104.35, 46273.43412605276, 46081.159300893356, 46118.651073875386, 1726.28)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:04:04.255 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 03:04:00.000000', 36837.36, 37322.33129735258, 36151.31817521867, 36418.59288748068, 7816.2542)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:04:04.264 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 03:04:00.000000', 41593.59, 42183.9906368696, 41528.16686280408, 41884.91149362372, 6171.704)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:04:04.268 | ERROR    | fullon_ohlcv.repositories.ohlcv.trade_repository | 194 | Failed to save trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_trades" does not exist
[SQL: 
                            INSERT INTO test.btc_usdt_trades 
                            (timestamp, price, volume, side, type)
                            VALUES ('2025-10-14 03:03:44.251314', 33739.3, 4.34611388, 'buy', 'market'), ('2025-10-14 03:03:45.251314', 49764.32, 2.04485968, 'sell', 'limit'), ('2025-10-14 03:03:46.251314', 39501.16, 7.89623732, 'sell', 'market'), ('2025-10-14 03:03:47.251314', 41203.82, 0.25502009, 'buy', 'limit'), ('2025-10-14 03:03:48.251314', 37298.41, 1.67323511, 'sell', 'limit'), ('2025-10-14 03:03:49.251314', 48448.17, 3.32101912, 'buy', 'limit'), ('2025-10-14 03:03:50.251314', 31727.18, 9.09854415, 'buy', 'limit'), ('2025-10-14 03:03:51.251314', 41063.33, 1.38606304, 'buy', 'limit'), ('2025-10-14 03:03:52.251314', 34062.93, 4.17122784, 'sell', 'market'), ('2025-10-14 03:03:53.251314', 49421.24, 1.56148698, 'sell', 'limit'), ('2025-10-14 03:03:54.251314', 34372.12, 1.44723316, 'buy', 'market'), ('2025-10-14 03:03:55.251314', 33154.22, 5.83847803, 'sell', 'limit'), ('2025-10-14 03:03:56.251314', 40426.74, 7.04824752, 'buy', 'market'), ('2025-10-14 03:03:57.251314', 44460.81, 9.43722563, 'sell', 'market'), ('2025-10-14 03:03:58.251314', 34908.19, 2.13323475, 'buy', 'limit'), ('2025-10-14 03:03:59.251314', 35908.4, 8.37516381, 'buy', 'market'), ('2025-10-14 03:04:00.251314', 34801.2, 4.43596579, 'buy', 'market'), ('2025-10-14 03:04:01.251314', 30197.01, 2.08597012, 'sell', 'market'), ('2025-10-14 03:04:02.251314', 42505.1, 3.21123606, 'sell', 'limit'), ('2025-10-14 03:04:03.251314', 42352.87, 9.33629249, 'sell', 'limit')
                            ON CONFLICT (timestamp) DO NOTHING
                        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:04:04.290 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:04:04.290 | INFO     | fullon_ohlcv_service.trade.historic_collector | 215 | Exchange has native OHLCV support - skipping trade collection exchange=kraken symbol_count=1
2025-10-14 03:04:04.296 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 03:04:04.297 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 03:04:04.299 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 03:04:04.300 | INFO     | fullon_ohlcv_service.daemon | 100 | Phase 1: Historic collection completed
2025-10-14 03:04:04.301 | INFO     | fullon_ohlcv_service.daemon | 109 | Phase 2: Starting live data streaming (WebSocket)
2025-10-14 03:04:04.302 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:04:04.304 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:04:04.307 | ERROR    | fullon_ohlcv.repositories.ohlcv.candle_repository | 148 | Failed to save candles: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedTableError'>: relation "test.btc_usdt_candles1m" does not exist
[SQL: 
                        INSERT INTO test.btc_usdt_candles1m
                        (timestamp, open, high, low, close, vol)
                        VALUES ('2025-10-14 03:04:00.000000', 35789.16, 36198.8877429176, 35546.06918033559, 35727.761141199226, 7242.466)
                        ON CONFLICT DO NOTHING
                    ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:04:04.310 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:04:04.311 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 03:04:04.312 | INFO     | fullon_cache.event_loop | 134 | Event loop configured: uvloop
2025-10-14 03:04:04.312 | INFO     | fullon_cache.connection | 121 | uvloop configured for optimal Redis performance
2025-10-14 03:04:04.323 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 03:04:04.342 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:04:04.343 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 03:04:04.351 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 03:04:04.356 | WARNING  | fullon_ohlcv_service.ohlcv.historic_collector | 68 | Historical collection already running
2025-10-14 03:04:04.370 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:04:04.372 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 200 | Failed to get REST handler for exchange exchange=kraken error=Handler creation failed
2025-10-14 03:04:04.376 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 169 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 03:04:04.391 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:04:04.393 | INFO     | fullon_ohlcv_service.trade.historic_collector | 215 | Exchange has native OHLCV support - skipping trade collection exchange=kraken symbol_count=1
2025-10-14 03:04:04.395 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 72 | Starting historical OHLCV collection
2025-10-14 03:04:04.396 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 114 | Historical collection completed total_symbols=0 total_candles=0
2025-10-14 03:04:04.411 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 72 | Starting historical OHLCV collection
2025-10-14 03:04:04.412 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=binance symbol_count=1
2025-10-14 03:04:04.413 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 199 | Failed to get REST handler for exchange exchange=binance error=object MagicMock can't be used in 'await' expression
2025-10-14 03:04:04.413 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 114 | Historical collection completed total_symbols=0 total_candles=0
2025-10-14 03:04:04.419 | WARNING  | fullon_ohlcv_service.ohlcv.historic_collector | 436 | Skipping candle with None values raw_candle=[1640995260000, None, 51500, 49500, 51000, 150]
2025-10-14 03:04:04.421 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:04:04.421 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 03:04:04.423 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 03:04:04.432 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:04:04.434 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:04:04.439 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:04:04.440 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 03:04:04.442 | WARNING  | fullon_ohlcv_service.ohlcv.live_collector | 42 | Live collection already running
2025-10-14 03:04:04.442 | INFO     | fullon_ohlcv_service.trade.historic_collector | 248 | Historical collection completed for symbol symbol=kraken:BTC/USD trades_collected=0
2025-10-14 03:04:04.446 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:04:04.447 | WARNING  | fullon_ohlcv_service.daemon | 230 | Error stopping collector during cleanup error=Stop failed
2025-10-14 03:04:04.450 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 74 | Stopping live OHLCV collection
2025-10-14 03:04:04.447 | WARNING  | fullon_ohlcv_service.daemon | 242 | Failed to update ProcessCache during cleanup error=Cache update failed
2025-10-14 03:04:04.448 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:04:04.465 | INFO     | fullon_ohlcv_service.trade.historic_collector | 190 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:04:04.466 | INFO     | fullon_ohlcv_service.trade.historic_collector | 222 | Exchange requires trade collection for OHLCV exchange=kraken symbol_count=1
2025-10-14 03:04:04.467 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 353 | Error collecting batch for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 03:04:04.468 | ERROR    | fullon_ohlcv_service.trade.historic_collector | 242 | Historical collection failed for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 03:04:04.469 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 86 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 03:04:04.475 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 03:04:04.476 | WARNING  | fullon_ohlcv_service.daemon | 75 | No symbols found in database - nothing to collect
2025-10-14 03:04:04.477 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:04:04.477 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:04:04.482 | INFO     | fullon_orm.uvloop_integration | 64 | uvloop event loop policy successfully installed
2025-10-14 03:04:04.487 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:04:04.488 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 03:04:04.489 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 241 | Historical collection completed for symbol symbol=kraken:BTC/USD candles_collected=0
2025-10-14 03:04:04.506 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:04:04.507 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 03:04:04.509 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 241 | Historical collection completed for symbol symbol=kraken:BTC/USD candles_collected=0
2025-10-14 03:04:04.531 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 189 | Starting historical collection for exchange exchange=kraken symbol_count=1
2025-10-14 03:04:04.532 | INFO     | fullon_ohlcv_service.ohlcv.historic_collector | 215 | Exchange supports native OHLCV - proceeding with collection exchange=kraken symbol_count=1
2025-10-14 03:04:04.534 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 364 | Error collecting batch for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 03:04:04.534 | ERROR    | fullon_ohlcv_service.ohlcv.historic_collector | 235 | Historical collection failed for symbol symbol=kraken:BTC/USD error=Collection failed
2025-10-14 03:04:04.543 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:04:04.543 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 132 | Exchange supports native OHLCV - proceeding with subscription exchange=binance symbol_count=1
2025-10-14 03:04:04.548 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 166 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 03:04:04.548 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 183 | Finished subscribing to OHLCV exchange=binance symbol_count=1
2025-10-14 03:04:04.591 | ERROR    | fullon_ohlcv_service.ohlcv.live_collector | 238 | Error processing OHLCV exchange=binance symbol=BTC/USDT error=not enough values to unpack (expected 6, got 1)
2025-10-14 03:04:04.598 | INFO     | fullon_ohlcv_service.daemon | 68 | Starting OHLCV Service Daemon
2025-10-14 03:04:04.599 | INFO     | fullon_ohlcv_service.daemon | 78 | Loaded symbols from database symbol_count=1
2025-10-14 03:04:04.600 | INFO     | fullon_ohlcv_service.daemon | 95 | Phase 1: Starting historic data collection (REST)
2025-10-14 03:04:04.601 | ERROR    | fullon_ohlcv_service.daemon | 119 | Daemon error error=OHLCV collection failed
2025-10-14 03:04:04.601 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:04:04.603 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:04:04.608 | INFO     | fullon_ohlcv_service.daemon | 222 | Starting daemon cleanup
2025-10-14 03:04:04.609 | INFO     | fullon_ohlcv_service.daemon | 244 | Daemon cleanup completed successfully
2025-10-14 03:04:04.622 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 291 | Symbol already collecting symbol_key=binance:BTC/USDT
2025-10-14 03:04:04.630 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=ETH/USDT
2025-10-14 03:04:04.635 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 353 | Added symbol to collector symbol=ETH/USDT exchange=binance
2025-10-14 03:04:04.649 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 356 | Creating new handler exchange=binance symbol=BTC/USDT
2025-10-14 03:04:04.671 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=BTC/USDT
2025-10-14 03:04:04.672 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 353 | Added symbol to collector symbol=BTC/USDT exchange=binance
2025-10-14 03:04:04.679 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:04:04.679 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 122 | Exchange requires trade collection instead of OHLCV - skipping OHLCV subscription exchange=binance symbol_count=1
2025-10-14 03:04:04.693 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 310 | Reusing existing handler exchange=binance symbol=BTC/USDT
2025-10-14 03:04:04.697 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 317 | Exchange needs trades for OHLCV, skipping exchange=binance symbol=BTC/USDT
2025-10-14 03:04:04.700 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 107 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:04:04.704 | INFO     | fullon_ohlcv_service.ohlcv.live_collector | 122 | Exchange requires trade collection instead of OHLCV - skipping OHLCV subscription exchange=binance symbol_count=1
2025-10-14 03:04:04.712 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:04.717 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:04.718 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:04.726 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:04.731 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:04.733 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:04.736 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:04.741 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:04.744 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:04.745 | INFO     | fullon_ohlcv_service.trade.batcher | 105 | Batch processing started
2025-10-14 03:04:04.754 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:04.755 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:04.755 | INFO     | fullon_ohlcv_service.trade.batcher | 87 | Symbol unregistered from batch processing exchange=kraken symbol=ETH/USD remaining_symbols=2
2025-10-14 03:04:04.761 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='138634422306192'>
2025-10-14 03:04:04.764 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='138634422314592'>
2025-10-14 03:04:04.765 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:04.766 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='138634422306192'>
2025-10-14 03:04:04.767 | WARNING  | fullon_ohlcv_service.trade.batcher | 359 | Failed to convert trade error='>' not supported between instances of 'MagicMock' and 'float' trade=<MagicMock id='138634422314592'>
2025-10-14 03:04:04.767 | INFO     | fullon_ohlcv_service.trade.batcher | 257 | Batch cycle completed - no trades to process total_symbols=2 duration_seconds=0.01
2025-10-14 03:04:04.769 | INFO     | fullon_ohlcv_service.trade.batcher | 105 | Batch processing started
2025-10-14 03:04:04.778 | INFO     | fullon_ohlcv_service.trade.batcher | 52 | GlobalTradeBatcher initialized
2025-10-14 03:04:04.779 | INFO     | fullon_ohlcv_service.daemon | 171 | Starting two-phase collection for single symbol symbol=BTC/USDC exchange=kraken
2025-10-14 03:04:04.780 | INFO     | fullon_ohlcv_service.daemon | 180 | Phase 1: Starting historic collection
2025-10-14 03:04:04.781 | INFO     | fullon_ohlcv_service.daemon | 188 | Phase 1: Historic collection completed
2025-10-14 03:04:04.782 | INFO     | fullon_ohlcv_service.daemon | 197 | Phase 2: Starting live streaming
2025-10-14 03:04:04.783 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDC
2025-10-14 03:04:04.805 | INFO     | fullon_ohlcv_service.trade.historic_collector | 169 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 03:04:04.811 | WARNING  | fullon_ohlcv_service.trade.historic_collector | 69 | Historical collection already running
2025-10-14 03:04:04.827 | INFO     | fullon_ohlcv_service.trade.historic_collector | 73 | Starting historical trade collection
2025-10-14 03:04:04.828 | INFO     | fullon_ohlcv_service.trade.historic_collector | 115 | Historical collection completed total_symbols=0 total_trades=0
2025-10-14 03:04:04.843 | WARNING  | fullon_ohlcv_service.trade.live_collector | 43 | Live collection already running
2025-10-14 03:04:04.856 | INFO     | fullon_ohlcv_service.trade.live_collector | 75 | Stopping live trade collection
2025-10-14 03:04:04.871 | INFO     | fullon_ohlcv_service.trade.live_collector | 94 | Loaded data symbol_count=1 exchange_count=1
2025-10-14 03:04:04.891 | INFO     | fullon_ohlcv_service.trade.historic_collector | 73 | Starting historical trade collection
2025-10-14 03:04:04.893 | WARNING  | fullon_ohlcv_service.trade.historic_collector | 92 | No admin exchange found for collection exchange=binance
2025-10-14 03:04:04.893 | INFO     | fullon_ohlcv_service.trade.historic_collector | 115 | Historical collection completed total_symbols=0 total_trades=0
2025-10-14 03:04:04.899 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:04:04.900 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 03:04:04.901 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 03:04:04.905 | INFO     | fullon_ohlcv_service.utils.add_symbols | 64 | Starting initialization of all symbols 
2025-10-14 03:04:04.907 | INFO     | fullon_ohlcv_service.utils.add_symbols | 75 | Found 1 symbols to initialize
2025-10-14 03:04:04.910 | INFO     | fullon_ohlcv_service.utils.add_symbols | 31 | Initializing symbol kraken:BTC/USDC'
2025-10-14 03:04:04.922 | INFO     | fullon_ohlcv_service.config.database_config | 75 | Loaded configuration exchanges=1 total_symbols=1
2025-10-14 03:04:04.930 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:04:04.932 | WARNING  | fullon_ohlcv_service.trade.live_collector | 166 | Failed to subscribe to trades exchange=binance symbol=BTC/USDT error=Subscription failed
2025-10-14 03:04:04.934 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 03:04:04.947 | ERROR    | fullon_ohlcv_service.trade.live_collector | 225 | Error processing trade exchange=binance error=Cache error
2025-10-14 03:04:04.955 | WARNING  | fullon_ohlcv_service.trade.live_collector | 192 | Trade object missing symbol attribute exchange=binance trade_obj=<Mock id='138634419318336'>
2025-10-14 03:04:04.985 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:04:04.987 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 03:04:04.989 | INFO     | fullon_ohlcv_service.trade.batcher | 105 | Batch processing started
2025-10-14 03:04:04.989 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 03:04:04.989 | ERROR    | fullon_ohlcv.repositories.ohlcv.base_repository | 426 | Failed to create hypertable for kraken.btc_usdc_trades: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedFunctionError'>: function create_hypertable(regclass, unknown, if_not_exists => boolean) does not exist
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[SQL: 
                    SELECT create_hypertable(
                        'kraken.btc_usdc_trades'::regclass,
                        'timestamp',
                        if_not_exists => TRUE
                    )
                ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-14 03:04:04.994 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 40 | Failed to initialize symbol kraken:BTC/USDC
2025-10-14 03:04:04.995 | ERROR    | fullon_ohlcv_service.utils.add_symbols | 95 | Failed to initialize symbol kraken:BTC/USDC
2025-10-14 03:04:04.995 | INFO     | fullon_ohlcv_service.utils.add_symbols | 97 | Symbol initialization complete: 0/1 successful
2025-10-14 03:04:04.996 | WARNING  | fullon_ohlcv_service.daemon | 145 | Symbol initialization failed - continuing anyway symbol=BTC/USDC exchange=kraken
2025-10-14 03:04:04.996 | ERROR    | fullon_ohlcv_service.daemon | 207 | Daemon in inconsistent state - cannot proceed
2025-10-14 03:04:05.009 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:04:05.009 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=BTC/USDT success=True
2025-10-14 03:04:05.010 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 03:04:05.007 | INFO     | fullon_ohlcv_service.trade.live_collector | 115 | Starting WebSocket for exchange exchange=binance symbol_count=1
2025-10-14 03:04:05.012 | INFO     | fullon_ohlcv_service.trade.live_collector | 154 | Subscription result exchange=binance symbol=ETH/USDT success=True
2025-10-14 03:04:05.018 | INFO     | fullon_ohlcv_service.trade.live_collector | 173 | Finished subscribing to trades exchange=binance symbol_count=1
2025-10-14 03:04:05.038 | INFO     | fullon_ohlcv_service.daemon | 171 | Starting two-phase collection for single symbol symbol=BTC/USDT exchange=binance
2025-10-14 03:04:05.038 | INFO     | fullon_ohlcv_service.daemon | 180 | Phase 1: Starting historic collection
2025-10-14 03:04:05.040 | INFO     | fullon_ohlcv_service.daemon | 188 | Phase 1: Historic collection completed
2025-10-14 03:04:05.041 | INFO     | fullon_ohlcv_service.daemon | 197 | Phase 2: Starting live streaming
2025-10-14 03:04:05.042 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
2025-10-14 03:04:05.146 | INFO     | fullon_ohlcv_service.daemon | 162 | Adding symbol to running daemon symbol=BTC/USDT exchange=binance
2025-10-14 03:04:05.146 | INFO     | fullon_ohlcv_service.daemon | 211 | Starting live collectors for symbol symbol=BTC/USDT
